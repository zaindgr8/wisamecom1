"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{53338:function(e,n,t){t.r(n),t.d(n,{Delay:function(){return ez},DocumentPane:function(){return tE},DocumentPaneProvider:function(){return nl},index:function(){return tD},useDeskTool:function(){return eK},useDeskToolSetting:function(){return nP}});var i,l,s,r,a,o,d,c,u,p,h,f,x,m,g,j,v,y,b,w,k,C,_,P,S,z,M=t(9268),E=t(86006),I=t(17719),L=t(1881),T=t(20075),R=t.n(T),O=t(79821),Z=t(82386),D=t(63623),F=t(26351),W=t(45234),A=t(47230),N=t(23894),U=t(83062),B=t(35842),X=t(30742),K=t(83448),V=t(93477),$=t(7891),q=t(53434),H=t(98047),Y=t(2278),J=t(90255),G=t(34837),Q=t(41561),ee=t(80473),en=t(10197),et=t(22461),ei=t(96454),el=t(80334),es=t(4974),er=t.n(es),ea=t(97589),eo=t(43269),ed=t(18488),ec=t(54911);t(31394),t(96665),t(64774),t(23102),t(53011),t(15542),t(70916);var eu=t(10854);t(76692);var ep=t(34268),eh=t(50374),ef=t(69482);t(28747),t(782);var ex=t(84231),em=t(40472),eg=t(63733),ej=t(7658),ev=t.n(ej),ey=t(90205),eb=t.n(ey),ew=t(60137),ek=t.n(ew),eC=t(15383),e_=t.n(eC),eP=t(20943);function eS(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function ez(e){let{children:n,ms:t=0}=e,[i,l]=(0,E.useState)(t<=0);return((0,E.useEffect)(()=>{if(t<=0)return;let e=setTimeout(()=>l(!0),t);return()=>{clearTimeout(e)}},[t]),i&&n)?"function"==typeof n?n():n:(0,M.jsx)(M.Fragment,{})}let eM=e=>{let{actions:n,children:t,actionProps:i,onActionComplete:l}=e;return(0,M.jsx)(ei.duV,{onReset:l,hooks:n,args:i,children:t})},eE=e=>{let{badges:n,children:t,badgeProps:i,...l}=e;return(0,M.jsx)(ei.duV,{...l,hooks:n,args:i,children:t})},eI=[];function eL(e){let{children:n,flatIndex:t,index:i,params:l,payload:s,siblingIndex:r}=e,{navigate:a,navigateIntent:o}=(0,ea.tv)(),d=(0,ea.z)(),c=(0,E.useMemo)(()=>(null==d?void 0:d.panes)||eI,[null==d?void 0:d.panes]),u=i-1,p=(0,E.useCallback)(e=>{let n=c[u]||[],t=n[r],i=e(n,t),l=[...c.slice(0,u),i,...c.slice(u+1)],s={...d||{},panes:l};return setTimeout(()=>a(s),0),s},[u,a,c,d,r]),h=(0,E.useCallback)(e=>{p((n,t)=>[...n.slice(0,r),{...t,payload:e},...n.slice(r+1)])},[p,r]),f=(0,E.useCallback)(e=>{p((n,t)=>[...n.slice(0,r),{...t,params:e},...n.slice(r+1)])},[p,r]),x=(0,E.useCallback)(e=>{let{id:n,parentRefPath:t,type:i,template:l}=e;a({panes:[...c.slice(0,u+1),[{id:n,params:{template:l.id,parentRefPath:(0,eh.BB)(t),type:i},payload:l.params}]]})},[u,a,c]),m=(0,E.useMemo)(()=>({index:t,groupIndex:u,siblingIndex:r,payload:s,params:l,hasGroupSiblings:!!c[u]&&c[u].length>1,groupLength:c[u]?c[u].length:0,routerPanesState:c,ChildLink:L.aL,BackLink:L.hb,ReferenceChildLink:L.HZ,handleEditReference:x,ParameterizedLink:L.V$,replaceCurrent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p(()=>[{id:e.id||"",payload:e.payload,params:e.params||{}}])},closeCurrent:()=>{p((e,n)=>e.length>1?e.filter(e=>e!==n):e)},duplicateCurrent:e=>{p((n,t)=>{let i={...t,payload:(null==e?void 0:e.payload)||t.payload,params:(null==e?void 0:e.params)||t.params};return[...n.slice(0,r),i,...n.slice(r)]})},setView:e=>{let n=R()(l,"view");return f(e?{...n,view:e}:n)},setParams:f,setPayload:h,navigateIntent:o}),[t,u,x,p,o,l,s,c,f,h,r]);return(0,M.jsx)(L.ud.Provider,{value:m,children:n})}let eT=[];class eR extends Error{constructor(e){let{message:n,context:t,helpId:i,cause:l}=e;super(n),this.context=t,this.helpId=i,this.cause=l}}let eO=new WeakMap;function eZ(e){let n=eO.get(e);if(n)return n;let t=(0,B.x0)();return eO.set(e,t),t}let eD=new WeakMap;function eF(e,n){let t=eD.get(e)||new Map;if(t){let e=t.get(n);if(e)return e}let i=e[n];if("function"!=typeof i)throw Error("Expected property `".concat(n,"` to be a function but got ").concat(typeof i," instead."));let l=i.bind(e);return t.set(n,l),eD.set(e,t),l}let eW=e=>!!e&&"function"==typeof(null==e?void 0:e.then),eA=e=>!!(0,ei.Uy$)(e)&&"function"==typeof e.serialize,eN=e=>(n,t,i)=>{try{return e(n,t,i)}catch(e){if(e instanceof eR)throw e;throw new eR({message:"string"==typeof(null==e?void 0:e.message)?e.message:"",context:t,cause:e})}},eU=e=>function(){return e(...arguments).pipe((0,X._)(1),(0,K.x)())};function eB(e){let n=eN(eU(e((e,t,i)=>{if(!e)throw new eR({message:"Pane returned no child",context:t,helpId:"structure-item-returned-no-child"});return eW(e)||(0,O.b)(e)?(0,Z.D)(e).pipe((0,V.w)(e=>n(e,t,i))):eA(e)?n(e.serialize(t),t,i):"function"==typeof e?n(e(t.id,t),t,i):(0,D.of)(e)})));return n}async function eX(e){let n=new Map,t=eB(e=>(t,i,l)=>{let s=t&&"".concat(eZ(t),"-").concat(i.path.join("__")),r=s&&n.get(s);if(r)return r;let a=e(t,i,l);return s&&n.set(s,a),a}),i=[[{id:"__edit__".concat(e.params.id),params:{...R()(e.params,["id"]),type:e.params.type},payload:e.payload}]];async function l(e){var n;let{currentId:i,flatIndex:s,intent:r,params:a,parent:o,path:d,payload:c,unresolvedPane:u,levelIndex:p,structureContext:h}=e;if(!u)return[];let{id:f,type:x,...m}=a,g=await (0,F.z)(t(u,{id:i,splitIndex:0,parent:o,path:d,index:s,params:{},payload:void 0,structureContext:h},s));return"document"===g.type&&g.id===f?[{panes:[...d.slice(0,d.length-1).map(e=>[{id:e}]),[{id:f,params:m,payload:c}]],depthIndex:d.length,levelIndex:p}]:(null==(n=g.canHandleIntent)?void 0:n.call(g,r,a,{pane:g,index:s}))||"documentList"===g.type&&g.schemaTypeName===x&&"_type == $type"===g.options.filter?[{panes:[...d.map(e=>[{id:e}]),[{id:a.id,params:m,payload:c}]],depthIndex:d.length,levelIndex:p}]:"list"===g.type&&g.child&&g.items?(await Promise.all(g.items.map((e,n)=>"divider"===e.type?Promise.resolve([]):l({currentId:e._id||e.id,flatIndex:s+1,intent:r,params:a,parent:g,path:[...d,e.id],payload:c,unresolvedPane:"function"==typeof g.child?eF(g,"child"):g.child,levelIndex:n,structureContext:h})))).flat():[]}let s=await l({currentId:"root",flatIndex:0,levelIndex:0,intent:e.intent,params:e.params,parent:null,path:[],payload:e.payload,unresolvedPane:e.rootPaneNode,structureContext:e.structureContext}),r=s.sort((e,n)=>e.depthIndex===n.depthIndex?e.levelIndex-n.levelIndex:e.depthIndex-n.depthIndex)[0];return r?r.panes:i}function eK(){let e=(0,E.useContext)(L.zJ);if(!e)throw Error("DeskTool: missing context value");return e}let eV=(e,n)=>{let t=e.replace(/^__edit__/,""),{params:i,payload:l,structureContext:{resolveDocumentNode:s}}=n,{type:r,template:a}=i;if(!r)throw Error("Document type for document with ID ".concat(t," was not provided in the router params."));let o=s({schemaType:r,documentId:t});return o=o.id("editor").title("Editor"),a&&(o=o.initialValueTemplate(a,l)),o.serialize()},e$=e=>{let n={type:e.type,id:e.routerPaneSibling.id,params:e.routerPaneSibling.params||{},payload:e.routerPaneSibling.payload||null,flatIndex:e.flatIndex,groupIndex:e.groupIndex,siblingIndex:e.siblingIndex,path:e.path,paneNode:"resolvedMeta"===e.type?eZ(e.paneNode):null};return"metaHash(".concat(JSON.stringify(n),")")};async function eq(e,n,t){if(n&&t)return{id:n,type:t};if(!n&&t)return{id:(0,eo.Z)(),type:t};if(n&&!t){let t=await (0,F.z)(e.resolveTypeForDocument(n));return{id:n,type:t}}throw new eR({message:"Neither document `id` or `type` was provided when trying to resolve intent."})}let eH={},eY=(0,E.memo)(function(){let{navigate:e}=(0,ea.tv)(),n=(0,ea.z)((0,E.useCallback)(e=>{let n="string"==typeof e.intent?e.intent:void 0;return n?{intent:n,params:(0,ei.Uy$)(e.params)?e.params:eH,payload:e.payload}:void 0},[])),{rootPaneNode:t,structureContext:i}=eK(),l=(0,ei.H__)(),[s,r]=(0,E.useState)(null);if(s)throw s;return(0,E.useEffect)(()=>{if(n){let{intent:s,params:a,payload:o}=n,d=!1;return(async function(){let{id:n,type:r}=await eq(l,"string"==typeof a.id?a.id:void 0,"string"==typeof a.type?a.type:void 0);if(d)return;let c=await eX({intent:s,params:{...a,id:n,type:r},payload:o,rootPaneNode:t,structureContext:i});d||e({panes:c},{replace:!0})})().catch(r),()=>{d=!0}}},[l,n,e,t,i]),null}),eJ=ed.ZP.span(i||(i=eS(["\n  &:not(:last-child)::after {\n    content: ' ➝ ';\n    opacity: 0.5;\n  }\n"])));function eG(e){let{error:n}=e;if(!(n instanceof eR))throw n;let{cause:t}=n,i=(null==t?void 0:t.stack)||n.stack,l=i&&!(t instanceof L.zc)&&!n.message.includes("Module build failed:"),s=t instanceof L.zc?t.path:[],r=t instanceof L.zc&&t.helpId||n.helpId,a=(0,E.useCallback)(()=>{window.location.reload()},[]);return(0,M.jsx)(I.Zb,{height:"fill",overflow:"auto",padding:4,sizing:"border",tone:"critical",children:(0,M.jsxs)(I.W2,{children:[(0,M.jsx)(I.X6,{as:"h2",children:"Encountered an error while reading structure"}),(0,M.jsxs)(I.Zb,{marginTop:4,padding:4,radius:2,overflow:"auto",shadow:1,tone:"inherit",children:[s.length>0&&(0,M.jsxs)(I.Kq,{space:2,children:[(0,M.jsx)(I.__,{children:"Structure path"}),(0,M.jsx)(I.EK,{children:s.slice(1).map((e,n)=>(0,M.jsx)(eJ,{children:e},"".concat(e,"-").concat(n)))})]}),(0,M.jsxs)(I.Kq,{marginTop:4,space:2,children:[(0,M.jsx)(I.__,{children:"Error"}),(0,M.jsx)(I.EK,{children:l?i.replace(/\(\.\.\.\)\./g,"(...)\n  .").replace(/__WEBPACK_IMPORTED_MODULE_\d+_+/g,"").replace(/___default\./g,".").replace(RegExp(" \\(https?:\\/\\/".concat(window.location.host),"g")," ("):n.message})]}),r&&(0,M.jsx)(I.xu,{marginTop:4,children:(0,M.jsx)(I.xv,{children:(0,M.jsx)("a",{href:(0,el.h)(r),rel:"noopener noreferrer",target:"_blank",children:"View documentation"})})}),(0,M.jsx)(I.xu,{marginTop:4,children:(0,M.jsx)(I.zx,{text:"Reload",icon:ec.bnu,tone:"primary",onClick:a})})]})]})})}function eQ(e){let{isSelected:n,pane:t,paneKey:i}=e,l=(0,ei.Uy$)(t)&&t.type||null;return(0,M.jsxs)(L.X6,{id:i,selected:n,children:[(0,M.jsx)(L.hX,{title:"Unknown pane type"}),(0,M.jsx)(L.Bh,{children:(0,M.jsx)(I.xu,{padding:4,children:"string"==typeof l?(0,M.jsxs)(I.xv,{as:"p",muted:!0,children:["Structure item of type ",(0,M.jsx)("code",{children:l})," is not a known entity."]}):(0,M.jsxs)(I.xv,{as:"p",muted:!0,children:["Structure item is missing required ",(0,M.jsx)("code",{children:"type"})," property."]})})})]})}function e0(e){let n=[{ms:300,message:"Loading…"},{ms:5e3,message:"Still loading…"}];if(ei.r8Q){let t=["Check console for errors?","Is your observable/promise resolving?",e.length>0?"Structure path: ".concat(e.join(" ➝ ")):""];n.push({ms:1e4,message:t.join("\n")})}let t=(0,D.of)(null);return(0,U.T)(...n.map(e=>{let{ms:n,message:i}=e;return t.pipe((0,G.h)(i),(0,Q.g)(n))}))}let e1=(0,ed.ZP)(I.kC)(l||(l=eS(["\n  opacity: 0;\n  transition: opacity 200ms;\n\n  &[data-mounted] {\n    opacity: 1;\n  }\n"]))),e2=(0,E.memo)(e=>{let{delay:n=300,flex:t,message:i=e0,minWidth:l,paneKey:s,path:r,selected:a,title:o,tone:d}=e,c=(0,E.useMemo)(()=>"function"==typeof i?i(r?r.split(";"):[]):i,[i,r]),[u,p]=(0,E.useState)(()=>"string"==typeof c?c:"Loading…");(0,E.useEffect)(()=>{if("object"!=typeof c||"function"==typeof c.subscribe)return;let e=c.subscribe(p);return()=>e.unsubscribe()},[c]);let[h,f]=(0,E.useState)(null),[x,m]=(0,E.useState)(!1);(0,E.useEffect)(()=>{if(h)return(0,I.RE)(()=>m(!0))},[h]);let g=(0,M.jsxs)(e1,{align:"center","data-mounted":x?"":void 0,direction:"column",height:"fill",justify:"center",ref:f,children:[(0,M.jsx)(I.$j,{muted:!0}),(o||u)&&(0,M.jsx)(I.xu,{marginTop:3,children:(0,M.jsx)(I.xv,{align:"center",muted:!0,size:1,children:o||u})})]});return(0,M.jsx)(L.X6,{flex:t,id:s,minWidth:l,selected:a,tone:d,children:(0,M.jsx)(L.Bh,{children:g})})});e2.displayName="LoadingPane";let e3={component:(0,E.lazy)(()=>t.e(793).then(t.bind(t,22793))),document:(0,E.lazy)(()=>t.e(318).then(t.bind(t,5318))),documentList:(0,E.lazy)(()=>t.e(766).then(t.bind(t,44766))),list:(0,E.lazy)(()=>t.e(830).then(t.bind(t,28830)))},e4=(0,E.memo)(function(e){let{active:n,childItemId:t,groupIndex:i,index:l,itemId:s,pane:r,paneKey:a,params:o,payload:d,path:c,selected:u,siblingIndex:p}=e,h=e3[r.type]||eQ;return(0,M.jsx)(eL,{flatIndex:l,index:i,params:o,payload:d,siblingIndex:p,children:(0,M.jsx)(E.Suspense,{fallback:(0,M.jsx)(e2,{paneKey:a,path:c,selected:u}),children:(0,M.jsx)(h,{childItemId:t||"",index:l,itemId:s,isActive:n,isSelected:u,paneKey:a,pane:r})})})},(e,n)=>{let{params:t={},payload:i=null,...l}=e,{params:s={},payload:r=null,...a}=n;if(!er()(t,s)||!er()(i,r))return!1;let o=new Set([...Object.keys(l),...Object.keys(a)]);for(let e of o)if(l[e]!==a[e])return!1;return!0});function e8(e){let{children:n,flex:t,minWidth:i,paneKey:l,title:s="Error",tone:r="critical"}=e;return(0,M.jsxs)(L.X6,{flex:t,id:l,minWidth:i,tone:r,children:[(0,M.jsx)(L.hX,{title:s}),(0,M.jsx)(L.Bh,{overflow:"auto",children:(0,M.jsx)(I.xu,{paddingX:4,paddingY:5,children:n})})]})}let e5=["patch","commit"],e6=(0,E.memo)(function(){let{push:e}=(0,I.pm)(),{documentId:n,documentType:t}=(0,L.Z3)(),i=(0,ei.E6V)(n,t),l=(0,E.useRef)(i);return(0,E.useEffect)(()=>{if(i&&i!==l.current){var n,t;"error"===i.type&&e({closable:!0,duration:3e4,status:"error",title:"delete"===(n=i.op)?"An error occurred while attempting to delete this document.\n      This usually means that there are other documents that refers to it.":"unpublish"===n?"An error occurred while attempting to unpublish this document.\n      This usually means that there are other documents that refers to it.":"An error occurred during ".concat(n),description:(0,M.jsxs)("details",{children:[(0,M.jsx)("summary",{children:"Details"}),i.error.message]})}),"success"!==i.type||e5.includes(i.op)||e({closable:!0,status:"success",title:"publish"===(t=i.op)?"The document was published":"unpublish"===t?"The document was unpublished. A draft has been created from the latest published version.":"discardChanges"===t?"All changes since last publish has now been discarded. The discarded draft can still be recovered from history":"delete"===t?"The document was successfully deleted":"Successfully performed ".concat(t," on document")}),l.current=i}},[i,e]),null}),e7=e=>{let{features:n,hasValue:t,changesOpen:i}=e;return n.reviewChanges?{action:"reviewChanges",title:"Review changes",icon:ec.vaD,isDisabled:i||!t}:null},e9=e=>{let{hasValue:n}=e;return{action:"inspect",title:"Inspect",icon:ec.bg6,isDisabled:!n,shortcut:"Ctrl+Alt+I"}},ne=e=>{let{previewUrl:n}=e;return n?{action:"production-preview",title:"Open preview",icon:ec.YE8,shortcut:"Ctrl+Alt+O"}:null},nn=e=>{let n=[ne,e7,e9].filter(Boolean).map(n=>n(e));return n.filter(e=>null!==e)},nt=e=>(0,ei.Uy$)(e)&&"string"==typeof e._id&&"string"==typeof e._type,ni={},nl=(0,E.memo)(e=>{let{children:n,index:t,pane:i,paneKey:l}=e,s=(0,ei.I_y)(),r=(0,ei.zEW)(),{actions:a,badges:o,unstable_languageFilter:d}=(0,ei.Lky)().document,c=(0,ei.ap5)(),u=(0,L.RL)(),{features:p}=eK(),{push:h}=(0,I.pm)(),{options:f,menuItemGroups:x,title:m=null,views:g=[]}=i,j=(0,ei.BoV)(f),v=j.id,y=(0,ei.vsM)(v),b=f.type,w=(0,ei.BoV)(u.params),k=(0,ei.BoV)(u.payload),{templateName:C,templateParams:_}=(0,E.useMemo)(()=>(function(e,n){let t=n.panePayload||{},i=n.templateName;n.urlTemplate&&i&&i!==n.urlTemplate&&console.warn('Conflicting templates: URL says "'.concat(n.urlTemplate,'", structure node says "').concat(i,'". Using "').concat(i,'".'));let l=i||n.urlTemplate,s=e.filter(e=>e.schemaType===n.documentType),r={...n.templateParams,..."object"==typeof t&&t||{}},a=l;return l||1!==s.length||(a=s[0].id),{templateName:a,templateParams:r}})(r,{documentType:b,templateName:j.template,templateParams:j.templateParameters,panePayload:k,urlTemplate:null==w?void 0:w.template}),[b,j,w,k,r]),P=(0,ei.t2O)({documentId:y,documentType:b,templateName:C,templateParams:_}),S=(0,ei.BoV)(P),{patch:z}=(0,ei.d9t)(y,b),T=(0,ei.iav)(y,b),{validation:O}=(0,ei.a3k)(y,b),F=(0,ei.z1O)(y,b),W=s.get(b),A=(null==T?void 0:T.draft)||(null==T?void 0:T.published)||S.value,N=(0,E.useMemo)(()=>a({schemaType:b,documentId:y}),[a,y,b]),U=(0,E.useMemo)(()=>o({schemaType:b,documentId:y}),[o,y,b]),B=(0,E.useMemo)(()=>d({schemaType:b,documentId:y}),[y,b,d]),X=(0,ei.BoV)(O),K=(0,ei.BoV)(g),$=u.params||ni,[q,H]=(0,E.useState)(()=>$.path?(0,eh.mL)($.path):[]),Y=$.view||K[0]&&K[0].id||null,[J,G]=(0,E.useState)("closed"),Q=!!$.since,[et,el]=(0,E.useState)(null),es=(0,ei.Dab)({documentId:y,documentType:b,onError:el,rev:$.rev,since:$.since}),er=(0,ei.P08)(es,e=>e.onOlderRevision),ea=(0,ei.P08)(es,e=>e.revTime),eo=(0,ei.P08)(es,e=>e.sinceAttributes),ed=(0,ei.P08)(es,e=>e.timelineDisplayed),ec=(0,ei.P08)(es,e=>e.timelineReady),eu=function(e){let[n,t]=(0,E.useState)(void 0),[i,l]=(0,E.useState)(null),{resolveProductionUrl:s}=(0,ei.Lky)().document,r=(0,ex.l)(e);if(i)throw i;return(0,E.useEffect)(()=>{r.pipe((0,ee.b)(500),(0,V.w)(e=>nt(e)?(0,Z.D)(s({document:e})):(0,D.of)(void 0)),(0,en.K)(e=>{let n=(0,ei.Uy$)(e)&&"string"==typeof e.message?e.message:"Unknown error";throw Error("An error was thrown while trying to get your preview url: ".concat(n))})).subscribe({next:t,error:l})},[s,r]),n}(A),[ef,eg]=(0,E.useState)([]);(0,E.useEffect)(()=>{let e=c.documentPresence(y).subscribe(e=>{eg(e)});return()=>{e.unsubscribe()}},[y,c]);let ej=!!A,ev=(0,E.useMemo)(()=>nn({features:p,hasValue:ej,changesOpen:Q,previewUrl:eu}),[Q,p,ej,eu]),ey="on"===$.inspect,eb=Q?eo:(null==T?void 0:T.published)||null,ew="connected"===F&&T.ready&&(ec||!!et),ek=(0,E.useMemo)(()=>er?ed||{_id:A._id,_type:A._type}:A,[er,ed,A]),eC=(0,E.useCallback)((e,n)=>{u.setParams({...u.params,since:e,rev:n||void 0})},[u]),e_=(0,E.useCallback)(e=>{H(e),c.setLocation([{type:"document",documentId:y,path:e,lastActiveAt:new Date().toISOString()}])},[y,c,H]),eP=(0,E.useCallback)(e=>{H([])},[H]),eS=(0,E.useRef)(()=>{throw Error("Nope")});eS.current=e=>{z.execute((0,ei.GWp)(e.patches),S.value)};let ez=(0,E.useCallback)(e=>eS.current(e),[]),eM=(0,E.useCallback)(()=>{u.setParams({...$,since:void 0})},[u,$]),eE=(0,E.useCallback)(()=>{u.setParams({...$,since:"@lastPublished"})},[u,$]),eI=(0,E.useCallback)(()=>u.closeCurrent(),[u]),eL=(0,E.useCallback)(()=>u.duplicateCurrent(),[u]),eT=(0,E.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!ey;e?u.setParams({...$,inspect:"on"}):u.setParams(R()($,"inspect"))},[ey,u,$]),eR=(0,E.useCallback)(e=>"production-preview"===e.action&&eu?(window.open(eu),!0):"inspect"===e.action?(eT(!0),!0):"reviewChanges"===e.action&&(eE(),!0),[eE,eu,eT]),eO=(0,E.useCallback)(e=>{for(let n of ev)if(n.shortcut&&(0,ep.ZP)(n.shortcut,e)){e.preventDefault(),e.stopPropagation(),eR(n);return}},[eR,ev]),eZ=(0,E.useCallback)(()=>eT(!1),[eT]),[eD,eF]=(0,E.useState)([]),[eW,eA]=(0,E.useState)(),[eN,eU]=(0,E.useState)(),[eB,eX]=(0,E.useState)(),eV=(0,E.useCallback)((e,n)=>{eU(t=>(0,ei.pt$)(t,e,n))},[]),e$=(0,E.useCallback)((e,n)=>{eX(t=>(0,ei.pt$)(t,e,n))},[]),eq=(0,E.useCallback)((e,n)=>eA(t=>(0,ei.pt$)(t,e,n)),[]),eH=A._createdAt?"update":"create",eY=(0,E.useMemo)(()=>!!(null==W?void 0:W.liveEdit),[null==W?void 0:W.liveEdit]),eJ=A._id?A._id:"dummy-id",eG=(0,E.useMemo)(()=>({...A,_id:eY?(0,ei.vsM)(eJ):(0,ei.qyu)(eJ)}),[eY,A,eJ]),[eQ,e0]=(0,ei.vSY)({document:eG,permission:eH}),e1=!(null==A?void 0:A._id),e2=(0,E.useMemo)(()=>{let e=!e0&&!(null==eQ?void 0:eQ.granted),n=!(0,em.jA)(W,"update"),t=e1&&!(0,em.jA)(W,"create"),i="reconnecting"===F;return!ew||null!==ea||e||n||t||i},[F,e1,e0,null==eQ?void 0:eQ.granted,ew,ea,W]),e3=(0,ei.clL)(W,{value:ek,readOnly:e2,comparisonValue:eb,focusPath:q,openPath:eD,collapsedPaths:eN,presence:ef,validation:X,collapsedFieldSets:eB,fieldGroupState:eW,changesOpen:Q}),e4=(0,E.useRef)(e3);e4.current=e3;let e8=(0,E.useCallback)(e=>{let n=(0,ei.C8M)(e4.current,e);n.forEach(e=>{"expandPath"===e.type&&eU(n=>(0,ei.pt$)(n,e.path,!1)),"expandFieldSet"===e.type&&eX(n=>(0,ei.pt$)(n,e.path,!1)),"setSelectedGroup"===e.type&&eA(n=>(0,ei.pt$)(n,e.path,e.groupName))}),eF(e)},[e4]);return(0,E.useEffect)(()=>{"reconnecting"===F&&h({id:"sanity/desk/reconnecting",status:"warning",title:(0,M.jsx)(M.Fragment,{children:"Connection lost. Reconnecting…"})})},[F,h]),(0,E.useEffect)(()=>{var e;if(ew&&$.path){let n=(0,eh.vW)(null==(e=e4.current)?void 0:e.value,(0,eh.mL)($.path));H(n),e8(n)}},[$.path,y,e8,ew]),(0,M.jsx)(L.cO.Provider,{value:{actions:N,activeViewId:Y,badges:U,changesOpen:Q,collapsedFieldSets:eB,collapsedPaths:eN,compareValue:eb,connectionState:F,displayed:ek,documentId:y,documentIdRaw:v,documentType:b,editState:T,focusPath:q,menuItems:ev,onBlur:eP,onChange:ez,onFocus:e_,onPathOpen:e8,onHistoryClose:eM,onHistoryOpen:eE,onInspectClose:eZ,onKeyUp:eO,onMenuAction:eR,onPaneClose:eI,onPaneSplit:eL,onSetActiveFieldGroup:eq,onSetCollapsedPath:eV,onSetCollapsedFieldSet:e$,index:t,inspectOpen:ey,validation:X,menuItemGroups:x||[],paneKey:l,previewUrl:eu,ready:ew,schemaType:W,isPermissionsLoading:e0,permissions:eQ,setTimelineMode:G,setTimelineRange:eC,timelineError:et,timelineMode:J,timelineStore:es,title:m,value:A,views:K,formState:e3,unstable_languageFilter:B},children:n})});nl.displayName="DocumentPaneProvider";let ns={create:"created",delete:"deleted",discardDraft:"discarded draft",initial:"created",editDraft:"edited",editLive:"live edited",publish:"published",unpublish:"unpublished"},nr={create:ec.agZ,delete:ec.XHJ,discardDraft:ec.Two,initial:ec.agZ,editDraft:ec.dY8,editLive:ec.dY8,publish:ec.EI4,unpublish:ec.xEY};function na(e){let{maxLength:n,userIds:t}=e;return(0,M.jsx)(I.Jh,{maxLength:n,children:t.map(e=>(0,M.jsx)(ei.YtX,{user:e,withTooltip:!0},e))})}let no=(0,ed.ZP)(I.kC)(e=>{var n;let{theme:t}=e,i=null==(n=t.sanity.color.base.skeleton)?void 0:n.from;return(0,ed.iv)(s||(s=eS(["\n    --timeline-hairline-width: 1px;\n    position: relative;\n    z-index: 2;\n    margin: 0;\n    padding: 0;\n\n    &::before {\n      position: absolute;\n      content: '';\n      height: 100%;\n      width: var(--timeline-hairline-width);\n      background: ",";\n      top: 0;\n      left: calc((100% - var(--timeline-hairline-width)) / 2);\n      z-index: 1;\n    }\n  "])),i)}),nd=(0,ed.ZP)(I.zx)(e=>{let{$selected:n}=e;return(0,ed.iv)(r||(r=eS(["\n    position: relative;\n    width: 100%;\n\n    /* Line styling */\n    &[data-first] ","::before {\n      height: 50%;\n      top: unset;\n      bottom: 0;\n    }\n\n    &[data-last] ","::before {\n      height: 50%;\n    }\n\n    ","\n  "])),no,no,n&&(0,ed.iv)(a||(a=eS(["\n      ","::before {\n        background: transparent;\n      }\n    "])),no))}),nc=(0,ed.ZP)(I.xu)(o||(o=eS(["\n  background: var(--card-bg-color);\n  border-radius: 50px;\n  position: relative;\n  z-index: 2;\n"]))),nu=(0,ed.ZP)(I.xv)(d||(d=eS(["\n  text-transform: capitalize;\n"]))),np=(0,ed.ZP)(I.xu)(c||(c=eS(["\n  min-width: 1rem;\n  margin-left: ",";\n"])),e=>{let{theme:n}=e;return"-".concat((0,I.hO)(n.sanity.space[1]))}),nh={initial:"primary",create:"primary",publish:"positive",editLive:"caution",editDraft:"caution",unpublish:"critical",discardDraft:"critical",delete:"critical",withinSelection:"primary"};function nf(e){let{chunk:n,isFirst:t,isLast:i,isLatest:l,isSelected:s,onSelect:r,timestamp:a,type:o}=e,d=nr[o],c=Array.from(n.authors),u=(0,E.useMemo)(()=>{let e=new Date(a),n=(0,eg.Z)(e,"MMM d, yyyy, hh:mm a");return n},[a]),p=(0,E.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),r(n)},[r,n]);return(0,M.jsx)(nd,{$selected:s,"data-chunk-id":n.id,"data-first":!!t||void 0,"data-last":!!i||void 0,"data-ui":"timelineItem",mode:s?"default":"bleed",onClick:p,padding:0,radius:2,tone:s?"primary":nh[n.type],children:(0,M.jsx)(I.xu,{paddingX:2,children:(0,M.jsxs)(I.kC,{align:"stretch",children:[(0,M.jsx)(no,{align:"center",children:(0,M.jsx)(nc,{padding:2,children:(0,M.jsx)(I.xv,{size:2,children:d&&(0,E.createElement)(d)})})}),(0,M.jsxs)(I.Kq,{space:2,margin:2,children:[l&&(0,M.jsx)(I.kC,{children:(0,M.jsx)(I.Zb,{padding:1,radius:2,shadow:1,tone:s?"primary":nh[n.type],children:(0,M.jsx)(I.__,{muted:!0,size:0,children:"Latest"})})}),(0,M.jsx)(I.xu,{children:(0,M.jsx)(nu,{size:1,weight:"medium",children:ns[o]||(0,M.jsx)("code",{children:o})})}),(0,M.jsx)(np,{paddingX:1,children:(0,M.jsx)(I.xv,{size:0,muted:!0,children:u})})]}),(0,M.jsx)(I.kC,{flex:1,justify:"flex-end",align:"center",children:(0,M.jsx)(na,{maxLength:3,userIds:c})})]})})})}let nx=(0,ed.ZP)(I.Kq)(u||(u=eS(["\n  max-width: 200px;\n"]))),nm=(0,ed.ZP)(I.kC)(p||(p=eS(["\n  max-height: calc(100vh - 198px);\n  min-width: 244px;\n"]))),ng=(0,ed.ZP)(I.xu)(e=>{let{$visible:n}=e;return(0,ed.iv)(h||(h=eS(["\n    opacity: 0;\n    pointer-events: none;\n\n    ","\n  "])),n&&(0,ed.iv)(f||(f=eS(["\n      opacity: 1;\n      pointer-events: auto;\n    "]))))}),nj=e=>{let{chunks:n,disabledBeforeFirstChunk:t,hasMoreChunks:i,lastChunk:l,onLoadMore:s,onSelect:r,firstChunk:a}=e,[o,d]=(0,E.useState)(!1),c=(0,E.useMemo)(()=>n.filter(e=>!t||!a||e.index<a.index),[n,t,a]),u=(0,E.useMemo)(()=>(null==l?void 0:l.id)?c.findIndex(e=>e.id===l.id):-1,[null==l?void 0:l.id,c]),p=(0,E.useCallback)((e,n)=>{let{activeIndex:l}=n,s=0===l,a=c&&l===c.length-1||!1;return(0,M.jsxs)(I.xu,{paddingBottom:a?1:0,paddingTop:s?1:0,paddingX:1,children:[(0,M.jsx)(nf,{chunk:e,isFirst:s,isLast:a,isLatest:0===l&&!t,isSelected:l===u,onSelect:r,timestamp:e.endTimestamp,type:e.type}),l===c.length-1&&i&&(0,M.jsx)(I.kC,{align:"center",justify:"center",padding:4,children:(0,M.jsx)(I.$j,{muted:!0})})]})},[t,c,i,r,u]);return(0,E.useEffect)(()=>d(!0),[]),(0,M.jsxs)(ng,{$visible:!u||o,"data-ui":"timeline",children:[0===c.length&&(0,M.jsxs)(nx,{padding:3,space:3,children:[(0,M.jsx)(I.xv,{size:1,weight:"semibold",children:"No document history"}),(0,M.jsx)(I.xv,{muted:!0,size:1,children:"When changing the content of the document, the document versions will appear in this menu."})]}),c.length>0&&(0,M.jsx)(nm,{direction:"column",children:(0,M.jsx)(ei.e8h,{activeItemDataAttr:"data-hovered",ariaLabel:"Document revisions",autoFocus:!0,initialIndex:u,initialScrollAlign:"center",itemHeight:40,items:c,onEndReached:s,onEndReachedIndexOffset:20,overscan:5,renderItem:p,wrapAround:!1})})]})};function nv(){return(0,M.jsxs)(I.kC,{align:"flex-start",gap:3,padding:4,children:[(0,M.jsx)(ei.LPT,{tone:"critical",children:(0,M.jsx)(ec.uIy,{})}),(0,M.jsxs)(I.Kq,{space:4,children:[(0,M.jsx)(ei.LPT,{size:1,tone:"critical",weight:"semibold",children:"An error occurred whilst retrieving document changes."}),(0,M.jsx)(ei.LPT,{size:1,tone:"critical",children:"Document history transactions have not been affected."})]})]})}nj.displayName="Timeline";let ny=(0,ed.ZP)(I.J2)(x||(x=eS(["\n  overflow: hidden;\n"])));function nb(e){let{chunk:n,mode:t,placement:i}=e,{setTimelineRange:l,setTimelineMode:s,timelineError:r,ready:a,timelineStore:o}=(0,L.Z3)(),[d,c]=(0,E.useState)(!1),[u,p]=(0,E.useState)(null),[h,f]=(0,E.useState)(null),x=(0,I.pm)(),m=(0,ei.P08)(o,e=>e.chunks),g=(0,ei.P08)(o,e=>e.isLoading),j=(0,ei.P08)(o,e=>e.hasMoreChunks),v=(0,ei.P08)(o,e=>e.realRevChunk),y=(0,ei.P08)(o,e=>e.sinceTime),b=(0,E.useCallback)(()=>{s(t),c(!0)},[t,s]),w=(0,E.useCallback)(()=>{s("closed"),c(!1)},[s]),k=(0,E.useCallback)(()=>{d&&w()},[w,d]),C=(0,E.useCallback)(e=>{d&&("Escape"===e.key||"Tab"===e.key)&&(w(),null==u||u.focus())},[u,w,d]);(0,I.O8)(k,[u,h]),(0,I.qh)(C);let _=(0,E.useCallback)(e=>{try{let[n,t]=o.findRangeForRev(e);s("closed"),l(n,t)}catch(e){x.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[s,l,o,x]),P=(0,E.useCallback)(e=>{try{let[n,t]=o.findRangeForSince(e);s("closed"),l(n,t)}catch(e){x.push({closable:!0,description:e.message,status:"error",title:"Unable to load revision"})}},[s,l,o,x]),S=(0,E.useCallback)(()=>{g||o.loadMore()},[g,o]),z=r?(0,M.jsx)(nv,{}):(0,M.jsxs)(M.Fragment,{children:["rev"===t&&(0,M.jsx)(nj,{chunks:m,firstChunk:v,hasMoreChunks:j,lastChunk:v,onLoadMore:S,onSelect:_}),"since"===t&&(0,M.jsx)(nj,{chunks:m,disabledBeforeFirstChunk:!0,firstChunk:v,hasMoreChunks:j,lastChunk:y,onLoadMore:S,onSelect:P})]}),T=function(e){let n=(0,E.useMemo)(()=>{let n=e?new Date(e):new Date,t=(0,eg.Z)(n,"MMM d, yyyy, hh:mm a");return t},[e]);return n}((null==n?void 0:n.endTimestamp)||""),R=n?"".concat(ev()(ns[n.type]),": ").concat(T):"Latest version",O=n?"Since: ".concat(T):"Since: unknown version",Z="rev"===t?R:O;return(0,M.jsx)(ny,{constrainSize:!0,content:d&&z,"data-ui":"versionMenu",open:d,placement:i,portal:!0,ref:f,children:(0,M.jsx)(I.zx,{disabled:!a,mode:"bleed",fontSize:1,padding:2,iconRight:ec.GVG,onClick:d?w:b,ref:p,selected:d,text:a?Z:"Loading history"})})}function nw(){return(0,M.jsx)(ez,{ms:300,children:(0,M.jsxs)(I.kC,{align:"center",direction:"column",height:"fill",justify:"center",paddingTop:3,children:[(0,M.jsx)(I.$j,{muted:!0}),(0,M.jsx)(I.xu,{marginTop:3,children:(0,M.jsx)(I.xv,{align:"center",muted:!0,size:1,children:"Loading changes"})})]})})}let nk=(0,ed.ZP)(ei.l$t)(m||(m=eS(["\n  height: 100%;\n  overflow: auto;\n  position: relative;\n  scroll-behavior: smooth;\n"])));function nC(){let{documentId:e,onHistoryClose:n,schemaType:t,timelineError:i,timelineStore:l,value:s}=(0,L.Z3)(),{collapsed:r}=(0,L.ec)(),a=(0,E.useRef)(null),o=(0,ei.P08)(l,e=>e.diff),d=(0,ei.P08)(l,e=>e.onOlderRevision),c=(0,ei.P08)(l,e=>e.selectionState),u=(0,ei.P08)(l,e=>e.sinceTime),p=!d,h=E.useMemo(()=>({documentId:e,schemaType:t,FieldWrapper:ei.MUX,rootDiff:o,isComparingCurrent:p,value:s}),[e,o,p,t,s]),f=E.useMemo(()=>o?function(e){let n=new Map;return(0,ei.Z7x)(e,e=>{if("unchanged"===e.action||!("annotation"in e)||!e.annotation)return!0;let{author:t,timestamp:i}=e.annotation,l=n.get(t);return(!l||l.timestamp<i)&&n.set(t,e.annotation),!0}),Array.from(n.values()).sort((e,n)=>e.timestamp<n.timestamp?1:-1)}(o):[],[o]);return r?null:(0,M.jsxs)(I.kC,{direction:"column",flex:1,style:{borderLeft:"1px dashed var(--card-border-color)",overflow:"hidden",minWidth:320},"data-testid":"review-changes-pane",children:[(0,M.jsx)(L.hX,{actions:(0,M.jsx)(I.zx,{icon:ec.Two,mode:"bleed",onClick:n,padding:3,title:"Hide changes panel"}),subActions:f.length>0&&(0,M.jsx)(I.xu,{paddingRight:1,children:(0,M.jsx)(ei.IIC,{annotations:f,description:"Changes by",placement:"bottom-end",children:(0,M.jsx)(I.Jh,{maxLength:4,children:f.map(e=>{let{author:n}=e;return(0,M.jsx)(ei.YtX,{user:n},n)})})})}),tabs:(0,M.jsx)(nb,{mode:"since",chunk:u,placement:"bottom-start"}),title:"Changes"}),(0,M.jsx)(L.Bh,{children:(0,M.jsx)(I.NM,{element:a.current,children:(0,M.jsx)(nk,{"data-ui":"Scroller",ref:a,children:(0,M.jsx)(I.xu,{flex:1,padding:4,children:(0,M.jsx)(n_,{diff:o,documentContext:h,error:i,loading:"loading"===c})})})})})]})}function n_(e){let{error:n,diff:t,documentContext:i,loading:l}=e,{schemaType:s}=(0,L.Z3)();return n?(0,M.jsx)(ei.kwM,{}):l?(0,M.jsx)(nw,{}):t?(0,M.jsx)(ei.H7Z.Provider,{value:i,children:(0,M.jsx)(ei.EyJ,{diff:t,schemaType:s})}):(0,M.jsx)(ei.kwM,{})}function nP(e,n,t){let i=(0,ei.F2f)(),[l,s]=(0,E.useState)(t),r=(0,E.useMemo)(()=>i.forNamespace("desk-tool"),[i]),a=(0,E.useMemo)(()=>e?r.forNamespace(e).forKey(n):r.forKey(n),[r,e,n]);(0,E.useEffect)(()=>{let e=a.listen(t).subscribe({next:s});return()=>null==e?void 0:e.unsubscribe()},[t,n,e,a]);let o=(0,E.useCallback)(e=>{s(e),a.set(e)},[a]);return(0,E.useMemo)(()=>[l,o],[o,l])}let nS={id:"parsed",title:"Parsed"},nz={id:"raw",title:"Raw JSON"},nM=[nS,nz],nE=ek()(1e3);function nI(e){let{path:n}=e,t=nE.get(n);void 0!==t&&nE.set(n,!t)}function nL(e){let n=window.getSelection();if(n){let t=document.createRange();n.removeAllRanges(),t.selectNodeContents(e),n.addRange(t)}}function nT(e){nL(e.currentTarget)}function nR(e){let n=65===e.keyCode&&(e.metaKey||e.ctrlKey);n&&(e.preventDefault(),nL(e.currentTarget))}let nO=ed.ZP.div(e=>{let{theme:n}=e,{color:t,fonts:i,space:l}=n.sanity;return(0,ed.iv)(g||(g=eS(["\n    & .json-inspector,\n    & .json-inspector .json-inspector__selection {\n      font-family: ",";\n      font-size: ","px;\n      line-height: ","px;\n      color: var(--card-code-fg-color);\n    }\n\n    & .json-inspector .json-inspector__leaf {\n      padding-left: ",";\n    }\n\n    & .json-inspector .json-inspector__leaf.json-inspector__leaf_root {\n      padding-top: ",";\n      padding-left: 0;\n    }\n\n    & .json-inspector > .json-inspector__leaf_root > .json-inspector__line > .json-inspector__key {\n      display: none;\n    }\n\n    & .json-inspector .json-inspector__line {\n      display: block;\n      position: relative;\n      cursor: default;\n    }\n\n    & .json-inspector .json-inspector__line::after {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: -200px;\n      right: -50px;\n      bottom: 0;\n      z-index: -1;\n      pointer-events: none;\n    }\n\n    & .json-inspector .json-inspector__line:hover::after {\n      background: var(--card-code-bg-color);\n    }\n\n    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line {\n      cursor: pointer;\n    }\n\n    & .json-inspector .json-inspector__leaf_composite > .json-inspector__line::before {\n      content: '▸ ';\n      margin-left: calc(0 - "," + 3px);\n      font-size: ","px;\n      line-height: ","px;\n    }\n\n    &\n      .json-inspector\n      .json-inspector__leaf_expanded.json-inspector__leaf_composite\n      > .json-inspector__line::before {\n      content: '▾ ';\n      font-size: ","px;\n      line-height: ","px;\n    }\n\n    & .json-inspector .json-inspector__radio,\n    & .json-inspector .json-inspector__flatpath {\n      display: none;\n    }\n\n    & .json-inspector .json-inspector__value {\n      margin-left: ",";\n    }\n\n    &\n      .json-inspector\n      > .json-inspector__leaf_root\n      > .json-inspector__line\n      > .json-inspector__key\n      + .json-inspector__value {\n      margin: 0;\n    }\n\n    & .json-inspector .json-inspector__key {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_helper,\n    & .json-inspector .json-inspector__value_null {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__not-found {\n      padding-top: ",";\n    }\n\n    & .json-inspector .json-inspector__value_string {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_boolean {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__value_number {\n      color: ",";\n    }\n\n    & .json-inspector .json-inspector__show-original {\n      display: inline-block;\n      padding: 0 6px;\n      cursor: pointer;\n    }\n\n    & .json-inspector .json-inspector__show-original:hover {\n      color: inherit;\n    }\n\n    & .json-inspector .json-inspector__show-original::before {\n      content: '↔';\n    }\n\n    & .json-inspector .json-inspector__show-original:hover::after {\n      content: ' expand';\n    }\n  "])),i.code.family,i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,(0,I.hO)(l[4]),(0,I.hO)(l[3]),(0,I.hO)(l[4]),i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,i.code.sizes[2].fontSize,i.code.sizes[2].lineHeight,(0,I.hO)(l[4]/2),t.syntax.property,t.syntax.constant,(0,I.hO)(l[3]),t.syntax.string,t.syntax.boolean,t.syntax.number)});function nZ(e){let{onChange:n,query:t}=e,i=(0,E.useCallback)(e=>n(e.target.value),[n]);return(0,M.jsx)(I.oi,{icon:ec.W1M,onChange:i,placeholder:"Search",radius:2,value:t||""})}function nD(e){let{value:n}=e,{onInspectClose:t,paneKey:i}=(0,L.Z3)(),l="".concat(i,"_inspect_"),[s,r]=nP("desk-tool","inspect-view-preferred-view-mode-".concat(i),"parsed"),a=nM.find(e=>e.id===s),o=(0,E.useCallback)(()=>{r(nS.id)},[r]),d=(0,E.useCallback)(()=>{r(nz.id)},[r]);return(0,M.jsx)(I.Vq,{id:"".concat(l,"dialog"),header:(0,ei.Uy$)(n)&&(0,ei.HD0)(n._id)&&(0,ei.HD0)(n._type)?(0,M.jsxs)(M.Fragment,{children:["Inspecting"," ",(0,M.jsx)("em",{children:(0,M.jsx)(L.lU,{document:n})})]}):(0,M.jsx)("em",{children:"No value"}),onClose:t,onClickOutside:t,width:3,children:(0,M.jsxs)(I.kC,{direction:"column",height:"fill",children:[(0,M.jsx)(I.Zb,{padding:3,shadow:1,style:{position:"sticky",bottom:0,zIndex:3},children:(0,M.jsxs)(I.td,{space:1,children:[(0,M.jsx)(I.OK,{"aria-controls":"".concat(l,"tabpanel"),fontSize:1,id:"".concat(l,"tab-").concat(nS.id),label:nS.title,onClick:o,selected:a===nS}),(0,M.jsx)(I.OK,{"aria-controls":"".concat(l,"tabpanel"),fontSize:1,id:"".concat(l,"tab-").concat(nz.id),label:nz.title,onClick:d,selected:a===nz})]})}),(0,M.jsxs)(I.x4,{"aria-labelledby":"".concat(l,"tab-").concat(s),flex:1,id:"".concat(l,"tabpanel"),overflow:"auto",padding:4,style:{outline:"none"},children:[a===nS&&(0,M.jsx)(nO,{children:(0,M.jsx)(eb(),{data:n,isExpanded:function e(n,t){let i=nE.get(n);return void 0===i?(nE.set(n,Array.isArray(t)||(0,ei.Uy$)(t)),e(n,t)):i},onClick:nI,search:nZ})}),a===nz&&(0,M.jsx)(I.EK,{language:"json",tabIndex:0,onKeyDown:nR,onDoubleClick:nT,onFocus:nT,children:JSON.stringify(n,null,2)})]})]})})}let nF=(0,ed.ZP)(I.Zb)(j||(j=eS(["\n  position: relative;\n  z-index: 50;\n"]))),nW=(0,ed.ZP)(I.xv)(v||(v=eS(["\n  & > * {\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n  }\n"]))),nA=(0,E.memo)(()=>{var e,n,t,i,l,s;let r=(0,ei.rq_)(),{params:a,groupIndex:o,routerPanesState:d,replaceCurrent:c,BackLink:u}=(0,L.RL)(),p=null==(e=d[o])?void 0:e[0].id,h=d[o-1],f=null==h?void 0:h[0],x=null==f?void 0:f.id,m=!!(null==(n=null==f?void 0:f.params)?void 0:n.rev),g=(0,E.useMemo)(()=>(null==a?void 0:a.parentRefPath)&&(0,eh.mL)(a.parentRefPath)||null,[null==a?void 0:a.parentRefPath]),j=(0,ex.m2)(()=>{let e=null==g?void 0:g[0];if(!x||!e||!g)return(0,D.of)({loading:!1});let n=(0,ei.vsM)(x),t=(0,eh.mL)(e),i=t.findIndex(e=>"object"==typeof e&&"_key"in e);return(0,W.z)((0,D.of)({loading:!0}),r.unstable_observePathsDocumentPair(n,-1===i?t:t.slice(0,i)).pipe((0,ee.b)(750),(0,$.U)(e=>{var n;let{draft:t,published:i}=e;return{loading:!1,result:{availability:{draft:t.availability,published:i.availability},refValue:null==(n=(0,eh.U2)(t.snapshot||i.snapshot,g))?void 0:n._ref}}})))},[r,x,g],{loading:!0}),v=(0,E.useCallback)(()=>{var e;!j.loading&&(null==(e=j.result)?void 0:e.refValue)&&c({id:j.result.refValue,params:a})},[j.loading,j.result,c,a]),y=!x||!g||m||j.loading||!(null==(t=j.result)?void 0:t.availability.draft.available)&&!(null==(i=j.result)?void 0:i.availability.published.available)||(null==(l=j.result)?void 0:l.refValue)===p;return y?null:(0,M.jsx)(nF,{shadow:1,tone:"caution","data-testid":"reference-changed-banner",children:(0,M.jsx)(I.W2,{paddingX:4,paddingY:2,sizing:"border",width:1,children:(0,M.jsxs)(I.kC,{align:"center",children:[(0,M.jsx)(I.xv,{size:1,children:(0,M.jsx)(ec.foC,{})}),(null==(s=j.result)?void 0:s.refValue)?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I.xu,{flex:1,marginLeft:3,children:(0,M.jsx)(nW,{title:"This reference has changed since you opened it.",size:1,children:"This reference has changed since you opened it."})}),(0,M.jsx)(I.xu,{marginLeft:3,children:(0,M.jsx)(I.zx,{onClick:v,icon:ec.bnu,fontSize:1,mode:"ghost",padding:2,space:2,text:"Reload reference"})})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I.xu,{flex:1,marginLeft:3,children:(0,M.jsx)(nW,{title:"This reference has been removed since you opened it.",size:1,children:"This reference has been removed since you opened it."})}),(0,M.jsx)(I.xu,{marginLeft:3,children:(0,M.jsx)(I.zx,{as:u,icon:ec.Two,fontSize:1,mode:"ghost",padding:2,space:2,text:"Close reference"})})]})]})})})});nA.displayName="ReferenceChangedBanner";let nN=(0,ed.ZP)(I.Zb)(y||(y=eS(["\n  position: relative;\n  z-index: 50;\n"])));function nU(e){var n,t;let{granted:i,requiredPermission:l}=e,s=(0,ei.xJ)(),r=(null==(n=null==s?void 0:s.roles)?void 0:n.length)!==1,a=((null==(t=null==s?void 0:s.roles)?void 0:t.map(e=>(0,M.jsx)("code",{children:e.title},e.name)))||[]).reduce((e,n)=>null===e?[n]:e.concat([", ",n]),null);return i?null:(0,M.jsx)(nN,{"data-testid":"permission-check-banner",shadow:1,tone:"transparent",children:(0,M.jsx)(I.W2,{paddingX:4,paddingY:3,sizing:"border",width:1,children:(0,M.jsxs)(I.kC,{align:"flex-start",children:[(0,M.jsx)(I.xv,{size:1,children:(0,M.jsx)(ec.CPA,{})}),(0,M.jsx)(I.xu,{flex:1,marginLeft:3,children:(0,M.jsxs)(I.xv,{size:1,children:["Your role",r&&"s"," ",a," ",r?"do":"does"," not have permissions to"," ",l," this document."]})})]})})})}let nB=e=>e.preventDefault();function nX(e){var n;let{hidden:t,margins:i}=e,{collapsedFieldSets:l,collapsedPaths:s,displayed:r,editState:a,documentId:o,documentType:d,onChange:c,validation:u,ready:p,formState:h,onFocus:f,onBlur:x,onSetCollapsedPath:m,onPathOpen:g,onSetCollapsedFieldSet:j,onSetActiveFieldGroup:v}=(0,L.Z3)(),y=(0,ei.H__)(),b=(0,ei.Dqo)(o),w=(0,E.useMemo)(()=>(0,ei.fm0)(),[]),k=null==(n=null==a?void 0:a.transactionSyncLock)?void 0:n.enabled;!function(e){let n=(0,I.pm)(),t=function(e){let n=(0,E.useRef)();return(0,E.useEffect)(()=>{n.current=e},[e]),n.current}(e.enabled);(0,E.useEffect)(()=>{!t&&e.enabled&&n.push({...e,duration:20736e5}),t&&!e.enabled&&n.push({...e,duration:.01})},[e,n,t])}({id:"sync-lock-".concat(o),status:"warning",enabled:k,title:"Syncing document…",description:"Please hold tight while the document is synced. This usually happens right after the document has been published, and it shouldn't take more than a few seconds"}),(0,E.useEffect)(()=>{let e=y.pair.documentEvents(o,d).pipe((0,et.b)(e=>{"mutation"===e.type&&w.publish(function(e){let n=e.mutations.map(e=>e.patch).filter(Boolean);return{type:"mutation",snapshot:e.document,patches:(0,ei.Sis)(e.origin,n)}}(e)),"rebase"===e.type&&w.publish(function(e){let n=e.remoteMutations.map(e=>e.patch).filter(Boolean),t=e.localMutations.map(e=>e.patch).filter(Boolean);return{type:"rebase",snapshot:e.document,patches:(0,ei.Sis)("remote",n).concat((0,ei.Sis)("local",t))}}(e))})).subscribe();return()=>{e.unsubscribe()}},[o,y,d,w]);let C=!!(null==r?void 0:r._rev);(0,E.useEffect)(()=>{C&&w.publish({type:"mutation",patches:[],snapshot:r})},[C]);let _=(0,E.useRef)(null);return(0,E.useEffect)(()=>{!p||(null==h?void 0:h.focusPath.length)||(0,I.fo)(_.current)},[p]),(0,M.jsx)(I.W2,{hidden:t,paddingX:4,paddingTop:5,paddingBottom:9,sizing:"border",width:1,children:(0,M.jsx)(ei.$rW,{margins:i,children:(0,M.jsx)(I.xu,{as:"form",onSubmit:nB,ref:_,children:p?null===h?(0,M.jsx)(I.xu,{padding:2,children:(0,M.jsx)(I.xv,{children:"This form is hidden"})}):(0,M.jsx)(ei.quP,{__internal_patchChannel:w,collapsedFieldSets:l,collapsedPaths:s,focusPath:h.focusPath,changed:h.changed,focused:h.focused,groups:h.groups,id:"root",members:h.members,onChange:c,onFieldGroupSelect:v,onPathBlur:x,onPathFocus:f,onPathOpen:g,onSetFieldSetCollapsed:j,onSetPathCollapsed:m,presence:b,readOnly:h.readOnly,schemaType:h.schemaType,validation:u,value:h.value}):(0,M.jsx)(ez,{ms:300,children:(0,M.jsxs)(I.kC,{align:"center",direction:"column",height:"fill",justify:"center",children:[(0,M.jsx)(I.$j,{muted:!0}),(0,M.jsx)(I.xu,{marginTop:3,children:(0,M.jsx)(I.xv,{align:"center",muted:!0,size:1,children:"Loading document"})})]})})})})})}function nK(){let{activeViewId:e,paneKey:n,views:t}=(0,L.Z3)(),i="".concat(n,"tabpanel");return(0,M.jsx)(I.td,{space:1,children:t.map((t,l)=>{var s;return(0,M.jsx)(nV,{icon:t.icon,id:"".concat(n,"tab-").concat(t.id),isActive:e===t.id,label:(0,M.jsx)(M.Fragment,{children:t.title}),tabPanelId:i,viewId:0===l?null:null!=(s=t.id)?s:null},t.id)})})}function nV(e){let{icon:n,id:t,isActive:i,label:l,tabPanelId:s,viewId:r}=e,{ready:a}=(0,L.Z3)(),{setView:o}=(0,L.RL)(),d=(0,E.useCallback)(()=>o(r),[o,r]);return(0,M.jsx)(I.OK,{"aria-controls":s,disabled:!a,fontSize:1,icon:n,id:t,selected:i,label:l,onClick:d})}let n$={error:{tone:"critical",icon:ec.uIy},warning:{tone:"caution",icon:ec.foC},info:{tone:"primary",icon:ec.hQ6}};function nq(e){let{boundaryElement:n,isOpen:t,setOpen:i}=e,{onFocus:l,onPathOpen:s,schemaType:r,validation:a}=(0,L.Z3)(),o=(0,E.useId)(),d=a.length>0,c=a.some(ef.YN),u=a.some(ef.WQ),p=a.some(ef.Ny),h=(0,E.useMemo)(()=>c?n$.error:u?n$.warning:p?n$.info:void 0,[c,p,u]),f=(0,E.useCallback)(e=>{s(e),l(e)},[l,s]),x=(0,E.useCallback)(()=>i(!1),[i]);return d?(0,M.jsx)(I.j2,{id:o||"",button:(0,M.jsx)(I.zx,{...h,title:"Show validation issues",mode:"bleed","data-testid":"validation-list-button"}),menu:(0,M.jsx)(I.v2,{open:t,children:(0,M.jsx)(ei.$L,{documentType:r,validation:a,onClose:x,onFocus:f})}),popover:{portal:!0,boundaryElement:n,constrainSize:!0,preventOverflow:!0,width:0},placement:"bottom"}):null}function nH(){let{connectionState:e,schemaType:n,title:t,value:i}=(0,L.Z3)(),{error:l,value:s}=(0,ei._2T)({enabled:!!i&&"connected"===e,schemaType:n,value:i});return"connected"!==e?(0,M.jsx)(M.Fragment,{}):t?(0,M.jsx)(M.Fragment,{children:t}):i?l?(0,M.jsxs)(M.Fragment,{children:["Error: ",l.message]}):(0,M.jsx)(M.Fragment,{children:(null==s?void 0:s.title)||(0,M.jsx)("span",{style:{color:"var(--card-muted-fg-color)"},children:"Untitled"})}):(0,M.jsxs)(M.Fragment,{children:["New ",(null==n?void 0:n.title)||(null==n?void 0:n.name)]})}let nY=e_()(e=>!!e.showAsAction),nJ=(0,E.memo)((0,E.forwardRef)((e,n)=>{let{rootElement:t}=e,{onMenuAction:i,onPaneClose:l,onPaneSplit:s,validation:r,menuItems:a,menuItemGroups:o,schemaType:d,timelineStore:c,ready:u,views:p,unstable_languageFilter:h}=(0,L.Z3)(),{features:f}=eK(),{index:x,BackLink:m,hasGroupSiblings:g}=(0,L.RL)(),j=(0,E.useMemo)(()=>a.filter(nY),[a]),[v,y]=E.useState(!1),b=p.length>1,w=f.reviewChanges,k=(0,ei.P08)(c,e=>e.revTime),C=f.splitViews&&s&&p.length>1,_=C&&g,P=!_&&!f.backButton;return(0,M.jsx)(L.hX,{ref:n,loading:!u,title:(0,M.jsx)(nH,{}),tabs:b&&(0,M.jsx)(nK,{}),backButton:f.backButton&&x>0&&(0,M.jsx)(I.zx,{as:m,"data-as":"a",icon:ec.Y4O,mode:"bleed"}),subActions:w&&(0,M.jsx)(nb,{chunk:k,mode:"rev",placement:"bottom-end"}),actions:(0,M.jsxs)(I.gF,{space:1,children:[h.length>0&&(0,M.jsx)(M.Fragment,{children:h.map((e,n)=>(0,E.createElement)(e,{key:"language-filter-".concat(n),schemaType:d}))}),r.length>0&&(0,M.jsx)(nq,{boundaryElement:t,isOpen:v,setOpen:y},"validation-menu"),(0,M.jsx)(L.eu,{itemGroups:o,items:j,onAction:i},"context-menu"),C&&(0,M.jsx)(I.zx,{icon:ec.iro,mode:"bleed",onClick:s,title:"Split pane right"},"split-pane-button"),_&&(0,M.jsx)(I.zx,{icon:ec.Two,mode:"bleed",onClick:l,title:"Close split pane"},"close-view-button"),P&&(0,M.jsx)(I.zx,{icon:ec.Two,mode:"bleed",title:"Close pane group",as:m},"close-view-button")]})})}));nJ.displayName="DocumentPanelHeader";let nG=(0,ed.ZP)(ei.l$t)(e=>{let{$disabled:n}=e;return n?{height:"100%"}:(0,ed.iv)(b||(b=eS(["\n    height: 100%;\n    overflow: auto;\n    position: relative;\n    scroll-behavior: smooth;\n    outline: none;\n  "])))}),nQ=function(e){let{footerHeight:n,isInspectOpen:t,rootElement:i,setDocumentPanelPortalElement:l}=e,{activeViewId:s,displayed:r,documentId:a,editState:o,value:d,views:c,ready:u,schemaType:p,permissions:h,isPermissionsLoading:f}=(0,L.Z3)(),{collapsed:x}=(0,L.Cc)(),m=(0,I.vI)(),{features:g}=eK(),[j,v]=(0,E.useState)(null),y=(0,I.XL)(j),b=(0,E.useRef)(null),[w,k]=(0,E.useState)(null),C=d._createdAt?"update":"create",_=(0,E.useMemo)(()=>c.find(e=>e.id===s)||c[0]||{type:"form"},[s,c]),P=g.splitPanes&&b.current||m.element,S=(0,E.useMemo)(()=>x?[(null==y?void 0:y.height)||0,0,n?n+2:2,0]:[0,0,2,0],[x,n,y]),z="form"!==_.type,T=(0,E.useMemo)(()=>"component"===_.type&&_.component&&(0,E.createElement)(_.component,{document:{draft:(null==o?void 0:o.draft)||null,displayed:r||d,historical:r,published:(null==o?void 0:o.published)||null},documentId:a,options:_.options,schemaType:p}),[_,r,a,null==o?void 0:o.draft,null==o?void 0:o.published,p,d]);(0,E.useEffect)(()=>{(null==w?void 0:w.scrollTo)&&w.scrollTo(0,0)},[a,w]),(0,E.useEffect)(()=>{P&&l(P)},[P,l]);let R=(0,E.useMemo)(()=>t?(0,M.jsx)(nD,{value:r||d}):null,[t,r,d]);return(0,M.jsxs)(I.kC,{direction:"column",flex:2,overflow:x?void 0:"hidden",children:[(0,M.jsx)(nJ,{rootElement:i,ref:v}),(0,M.jsx)(L.Bh,{children:(0,M.jsx)(I.Xp,{element:P,__unstable_elements:{documentScrollElement:w},children:(0,M.jsxs)(I.NM,{element:w,children:["form"===_.type&&!f&&u&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(nU,{granted:!!(null==h?void 0:h.granted),requiredPermission:C}),(0,M.jsx)(nA,{})]}),(0,M.jsxs)(nG,{$disabled:x||!1,"data-testid":"document-panel-scroller",ref:k,children:[(0,M.jsx)(nX,{hidden:z,margins:S},a+(u?"_ready":"_pending")),T]}),R,(0,M.jsx)("div",{"data-testid":"document-panel-portal",ref:b})]})})})]})},n0=["left","bottom"],n1={small:0,medium:1,large:2,full:"auto"};function n2(e){let{dialog:n,referenceElement:t}=e;return(0,M.jsx)(I.J2,{content:(0,M.jsx)(n3,{dialog:n}),fallbackPlacements:n0,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:t})}function n3(e){let{dialog:n}=e,{cancelButtonIcon:t,cancelButtonText:i,confirmButtonIcon:l,confirmButtonText:s,message:r,onCancel:a,onConfirm:o,tone:d}=n,{isTopLayer:c}=(0,I.sJ)(),[u,p]=(0,E.useState)(null),h=(0,E.useCallback)(()=>{c&&a()},[c,a]),f=(0,E.useCallback)(e=>{"Escape"===e.key&&c&&a()},[c,a]);return(0,I.O8)(h,[u]),(0,I.qh)(f),(0,M.jsxs)(I.kC,{direction:"column",ref:p,style:{minWidth:304,maxWidth:400},children:[(0,M.jsx)(I.xu,{flex:1,overflow:"auto",padding:4,children:(0,M.jsx)(I.xv,{children:r})}),(0,M.jsx)(I.xu,{paddingX:4,paddingY:3,style:{borderTop:"1px solid var(--card-border-color)"},children:(0,M.jsxs)(I.rj,{columns:2,gap:2,children:[(0,M.jsx)(I.zx,{icon:t,onClick:a,mode:"ghost",text:i||"Cancel"}),(0,M.jsx)(I.zx,{icon:l,onClick:o,text:s||"Confirm",tone:d})]})})]})}function n4(e){let{dialog:n}=e,t=(0,E.useId)(),i=n.footer&&(0,M.jsx)(I.xu,{paddingX:4,paddingY:3,children:n.footer});return(0,M.jsx)(ei.jr5,{zOffset:"fullscreen",children:(0,M.jsx)(I.Vq,{__unstable_hideCloseButton:!1===n.showCloseButton,footer:i,header:n.header,id:t,onClose:n.onClose,onClickOutside:n.onClose,width:void 0===n.width?1:n1[n.width],portal:"documentPanelPortalElement",children:(0,M.jsx)(I.xu,{padding:4,children:n.content})})})}function n8(e){let{dialog:n,referenceElement:t}=e;return(0,M.jsx)(I.J2,{content:(0,M.jsx)(n5,{dialog:n}),fallbackPlacements:n0,open:!0,placement:"top",portal:!0,preventOverflow:!0,referenceElement:t})}function n5(e){let{dialog:n}=e,{content:t,onClose:i}=n,{isTopLayer:l}=(0,I.sJ)(),[s,r]=(0,E.useState)(null),a=(0,E.useCallback)(()=>{l&&i()},[l,i]),o=(0,E.useCallback)(e=>{"Escape"===e.key&&l&&i()},[l,i]);return(0,I.O8)(a,[s]),(0,I.qh)(o),(0,M.jsx)("div",{ref:r,children:t})}function n6(e){let{dialog:n,referenceElement:t=null}=e,i=(0,E.useId)();return"confirm"===n.type?(0,M.jsx)(n2,{dialog:n,referenceElement:t}):"popover"===n.type?(0,M.jsx)(n8,{dialog:n,referenceElement:t}):"dialog"!==n.type&&n.type?(console.warn("Unsupported modal type ".concat(n.type)),(0,M.jsx)(I.Vq,{id:i,onClose:n.onClose,onClickOutside:n.onClose,width:2,children:(0,M.jsx)(I.xu,{padding:4,children:n.content||(0,M.jsxs)(M.Fragment,{children:["Unexpected modal type (",(0,M.jsx)("code",{children:n.type}),")"]})})})):(0,M.jsx)(n4,{dialog:n})}function n7(e){let{actionStates:n,disabled:t}=e,i=(0,E.useId)(),l=(0,E.useRef)(null),[s,r]=(0,E.useState)(-1),[a,o]=(0,E.useState)(null),d=(0,E.useCallback)(e=>{r(e)},[]),c=(0,E.useMemo)(()=>({placement:"top-end",portal:!0,preventOverflow:!0}),[]),u=n[s];return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I.j2,{id:"".concat(i,"-action-menu"),button:(0,M.jsx)(I.zx,{"data-testid":"action-menu-button","aria-label":"Open document actions",disabled:t,icon:ec.v4q,mode:"ghost",ref:l}),menu:(0,M.jsx)(I.v2,{padding:1,children:n.map((e,n)=>(0,M.jsx)(n9,{actionState:e,disabled:t,index:n,onAction:d},n))}),popover:c,ref:o}),u&&u.dialog&&(0,M.jsx)(ei.jr5,{zOffset:"paneFooter",children:(0,M.jsx)(n6,{dialog:u.dialog,referenceElement:a})})]})}function n9(e){let{actionState:n,disabled:t,index:i,onAction:l}=e,{onHandle:s}=n,r=(0,E.useCallback)(()=>{l(i),s&&s()},[i,l,s]),a=n.title&&(0,M.jsx)(I.xu,{padding:2,children:(0,M.jsx)(I.xv,{size:1,children:n.title})});return(0,M.jsx)(I.sN,{"data-testid":"action-".concat(n.label.replace(" ","")),disabled:t||!!n.disabled,onClick:r,padding:0,tone:n.tone,children:(0,M.jsx)(I.u,{content:a,disabled:!a,fallbackPlacements:["left","bottom"],placement:"top",portal:!0,children:(0,M.jsxs)(I.kC,{align:"center",paddingX:3,children:[(0,M.jsxs)(I.kC,{flex:1,paddingY:3,children:[n.icon&&(0,M.jsx)(I.xu,{marginRight:3,children:(0,M.jsxs)(I.xv,{children:[(0,E.isValidElement)(n.icon)&&n.icon,(0,eu.isValidElementType)(n.icon)&&(0,E.createElement)(n.icon)]})}),(0,M.jsx)(I.xv,{children:n.label})]}),n.shortcut&&(0,M.jsx)(I.xu,{marginLeft:3,children:(0,M.jsx)(I.p8,{keys:String(n.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1))})})]})})})}function te(e){let{disabled:n,showMenu:t,states:i}=e,[l,...s]=i,[r,a]=(0,E.useState)(null),o=(0,E.useMemo)(()=>l&&(l.title||l.shortcut)?(0,M.jsxs)(I.kC,{padding:2,style:{maxWidth:300},align:"center",children:[(0,M.jsx)(I.xv,{size:1,children:l.title}),l.shortcut&&(0,M.jsx)(I.xu,{marginLeft:l.title?2:0,children:(0,M.jsx)(I.p8,{keys:String(l.shortcut).split("+").map(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase())})})]}):null,[l]);return(0,M.jsxs)(I.kC,{children:[l&&(0,M.jsx)(I.li,{zOffset:200,children:(0,M.jsx)(I.u,{disabled:!o,content:o,portal:!0,placement:"top",children:(0,M.jsx)(I.Kq,{flex:1,children:(0,M.jsx)(I.zx,{"data-testid":"action-".concat(l.label),disabled:n||!!l.disabled,icon:l.icon,onClick:l.onHandle,ref:a,text:l.label,tone:l.tone||"primary"})})})}),t&&s.length>0&&(0,M.jsx)(I.xu,{marginLeft:1,children:(0,M.jsx)(n7,{actionStates:s,disabled:n})}),l&&l.dialog&&(0,M.jsx)(n6,{dialog:l.dialog,referenceElement:r})]})}let tn=(0,E.memo)(function(){let{actions:e,connectionState:n,documentId:t,editState:i}=(0,L.Z3)();return e&&i?(0,M.jsx)(eM,{actions:e,actionProps:i,children:i=>{let{states:l}=i;return(0,M.jsx)(te,{disabled:"connected"!==n,showMenu:e.length>1,states:l},t)}}):null}),tt=(0,E.memo)(function(){let{connectionState:e,editState:n,timelineStore:t}=(0,L.Z3)(),i=(0,ei.P08)(t,e=>e.revTime),l=(null==i?void 0:i.id)||"",s=((null==n?void 0:n.draft)||(null==n?void 0:n.published)||{})._rev===l,r=(0,E.useMemo)(()=>({...n||{},revision:l}),[n,l]),a=(0,E.useMemo)(()=>[L.Ty],[]);return(0,M.jsx)(eM,{actions:a,actionProps:r,children:n=>{let{states:t}=n;return(0,M.jsx)(te,{disabled:"connected"!==e||!!s,showMenu:!1,states:t})}})}),ti={primary:"primary",success:"positive",warning:"caution",danger:"critical"};function tl(e){let{states:n}=e;return(0,M.jsx)(I.gF,{space:1,children:n.map((e,n)=>(0,M.jsx)(I.u,{content:e.title&&(0,M.jsx)(I.xu,{padding:2,children:(0,M.jsx)(I.xv,{size:1,children:e.title})}),disabled:!e.title,placement:"top",portal:!0,children:(0,M.jsx)(I.Ct,{fontSize:1,mode:"outline",paddingX:2,paddingY:1,radius:4,tone:e.color?ti[e.color]:void 0,style:{whiteSpace:"nowrap"},children:e.label})},String(n)))})}function ts(){let{badges:e,editState:n}=(0,L.Z3)();return n&&e?(0,M.jsx)(eE,{badges:e,badgeProps:n,children:e=>{let{states:n}=e;return(0,M.jsx)(tl,{states:n})}}):null}let tr=(0,ed.ZP)(I.kC)(w||(w=eS(["\n  cursor: default;\n"])));function ta(e){let{collapsed:n,disabled:t,lastPublished:i,lastUpdated:l,liveEdit:s}=e,r=(0,ei.INm)(i||"",{minimal:!0,agoSuffix:!0}),a=(0,ei.INm)(i||"",{minimal:!0}),o=(0,ei.INm)(l||"",{minimal:!0,agoSuffix:!0}),d=(0,ei.INm)(l||"",{minimal:!0});return(0,M.jsx)(tr,{align:"center","data-ui":"SessionLayout",sizing:"border",children:(0,M.jsx)(I.u,{placement:"top",portal:!0,content:(0,M.jsx)(I.Kq,{padding:3,space:3,children:(0,M.jsx)(I.xv,{size:1,muted:!0,children:s?(0,M.jsxs)(M.Fragment,{children:["Last updated ",l?o:r]}):(0,M.jsxs)(M.Fragment,{children:["Last published ",r]})})}),children:(0,M.jsx)(I.zx,{mode:"bleed",tone:s?"critical":"positive",tabIndex:-1,disabled:t,children:(0,M.jsxs)(I.kC,{align:"center",children:[(0,M.jsx)(I.xu,{marginRight:n?0:3,children:(0,M.jsx)(I.xv,{size:2,children:s?(0,M.jsx)(ec.o1U,{}):(0,M.jsx)(ec.EI4,{})})}),!n&&(0,M.jsx)(I.xv,{size:1,weight:"medium",children:s?(0,M.jsx)(M.Fragment,{children:l?d:a}):a})]})})})})}let to=(0,ed.ZP)(eP.E.path)(k||(k=eS(["\n  transform-origin: center;\n"]))),td=e=>(0,M.jsx)(eP.E.circle,{fill:"none",r:"8",cx:"12.5",cy:"12.5",strokeWidth:"1.2",...e}),tc=e=>(0,M.jsx)(to,{fill:"none",d:"M14 17.5619L11.5 20.5L14.5 23.0619M11 7.43811L13.5 4.50001L10.5 1.93811",...e}),tu=e=>(0,M.jsx)(eP.E.path,{d:"M9.5 12.1316L11.7414 14.5L16 10",...e}),tp=e=>(0,M.jsx)(eP.E.path,{d:"M15 7L18 10M6 19L7 15L17 5L20 8L10 18L6 19Z",...e}),th=(0,ed.F4)(C||(C=eS(["\n  0% {\n    transform: rotate(0);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n"]))),tf=ed.ZP.g(_||(_=eS(["\n  transform-origin: center;\n\n  &[data-rotate] {\n    animation: "," 1s ease-in-out infinite;\n  }\n"])),th),tx={syncing:{scale:1,transition:{duration:0}},saved:{scale:[1,.8,1.2,.9,1.1,.95,1.05,.99,1],transition:{duration:.5,delay:.2}},changes:{transition:{duration:0}}},tm={syncing:{strokeDasharray:"0, 0, 23, 3, 23, 3",strokeDashoffset:10,opacity:1,transition:{duration:0}},saved:{strokeDasharray:"0, 0, 23, 0, 23, 0",strokeDashoffset:10,opacity:1,transition:{duration:.2}},changes:{strokeDasharray:"0, 60, 23, 0, 23, 0",strokeDashoffset:0,opacity:0,transition:{duration:.5}}},tg={syncing:{opacity:1,transition:{duration:0}},saved:{opacity:0,transition:{duration:.2}},changes:{opacity:0}},tj={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:1,transition:{delay:.4,duration:.3}},changes:{pathLength:0,transition:{duration:.2}}},tv={syncing:{pathLength:0,transition:{duration:0}},saved:{pathLength:0,transition:{duration:0}},changes:{pathLength:1,transition:{duration:.4,delay:.5}}};function ty(e){let{status:n}=e;return n?(0,M.jsx)("svg",{width:"1em",height:"1em",viewBox:"0 0 25 25",fill:"none",stroke:"currentColor",strokeWidth:"1.2","data-sanity-icon":"",children:(0,M.jsxs)(eP.E.g,{variants:tx,initial:n,animate:n,children:[(0,M.jsxs)(tf,{"data-rotate":"changes"===n?void 0:"",children:[(0,M.jsx)(tc,{variants:tg,initial:n,animate:n}),(0,M.jsx)(td,{variants:tm,initial:n,animate:n})]}),(0,M.jsx)(tu,{variants:tj,initial:n,animate:n}),(0,M.jsx)(tp,{variants:tv,initial:n,animate:n})]})}):null}let tb=E.forwardRef(function(e,n){let{collapsed:t,status:i,lastUpdated:l,...s}=e,r=(0,ei.INm)(l||"",{minimal:!0}),a=(0,ei.INm)(l||"",{minimal:!0,agoSuffix:!0}),o=(0,E.useMemo)(()=>"syncing"===i?{text:"Saving...",tone:void 0}:"changes"===i?{text:r,tone:"caution"}:"saved"===i?{text:"Saved!",tone:"positive"}:{},[i,r]);return i?(0,M.jsx)(I.u,{placement:"top",portal:!0,disabled:"changes"!==i,content:(0,M.jsxs)(I.Kq,{padding:3,space:3,children:[(0,M.jsx)(I.xv,{size:1,weight:"semibold",children:"Review changes"}),(0,M.jsxs)(I.xv,{size:1,muted:!0,children:["Changes saved ",a]})]}),children:(0,M.jsx)(I.zx,{mode:"bleed",justify:"flex-start",tone:null==o?void 0:o.tone,...s,"data-testid":"review-changes-button",ref:n,children:(0,M.jsxs)(I.kC,{align:"center",children:[(0,M.jsx)(I.xu,{marginRight:t?0:3,children:(0,M.jsx)(I.xv,{children:(0,M.jsx)(ty,{status:i})})}),!t&&(0,M.jsx)(I.xv,{size:1,weight:"medium",children:null==o?void 0:o.text})]})})}):null}),tw=E.memo(tb),tk=(0,E.memo)(function(){var e;let{changesOpen:n,documentId:t,documentType:i,editState:l,onHistoryClose:s,onHistoryOpen:r,timelineStore:a,value:o}=(0,L.Z3)(),d=(0,ei.nuD)(t,i),c=null==o?void 0:o._updatedAt,u=null==(e=null==l?void 0:l.published)?void 0:e._updatedAt,p=!!(null==l?void 0:l.liveEdit),h=!!(null==l?void 0:l.published),f=!!(null==l?void 0:l.draft),[x,m]=(0,E.useState)(null),g=(0,I.XL)(x),j=!g||(null==g?void 0:g.width)<300,[v,y]=(0,E.useState)(null),b=(0,ei.P08)(a,e=>e.onOlderRevision);(0,E.useEffect)(()=>{if("syncing"===v&&!d.isSyncing){let e=setTimeout(()=>y("saved"),1e3);return()=>clearTimeout(e)}if("saved"===v){let e=setTimeout(()=>y(null),3e3);return()=>clearTimeout(e)}},[v,c,d.isSyncing]),(0,E.useLayoutEffect)(()=>{y(null)},[t]),(0,E.useLayoutEffect)(()=>{d.isSyncing&&y("syncing")},[d.isSyncing,c]);let w=(0,E.useMemo)(()=>(0,M.jsx)(tw,{lastUpdated:c,status:v||(f?"changes":void 0),onClick:n?s:r,disabled:b,selected:n,collapsed:j}),[f,n,s,r,c,b,v,j]),k=(0,E.useMemo)(()=>(p||h)&&(0,M.jsx)(I.xu,{marginRight:1,children:(0,M.jsx)(ta,{disabled:b,lastPublished:u,lastUpdated:c,liveEdit:p,collapsed:j})}),[j,u,c,p,h,b]);return(0,M.jsxs)(I.kC,{align:"center","data-ui":"DocumentSparkline",ref:m,children:[k,(0,M.jsxs)(I.kC,{align:"center",flex:1,children:[w,!j&&(0,M.jsx)(I.xu,{marginLeft:3,children:(0,M.jsx)(ts,{})})]})]})}),tC=(0,ed.ZP)(I.xu)(P||(P=eS(["\n  min-width: 10em;\n  max-width: 16em;\n"])));function t_(e){let{actionsBoxRef:n}=e,{badges:t,timelineStore:i}=(0,L.Z3)(),l=(0,ei.P08)(i,e=>e.onOlderRevision);return(0,E.useMemo)(()=>(0,M.jsx)(I.xu,{paddingLeft:2,paddingRight:[2,3],paddingY:2,children:(0,M.jsxs)(I.kC,{align:"center",children:[(0,M.jsx)(I.xu,{flex:[1,2],children:t&&(0,M.jsx)(tk,{})}),(0,M.jsx)(tC,{flex:1,marginLeft:[1,3],ref:n,children:l?(0,M.jsx)(tt,{}):(0,M.jsx)(tn,{})})]})}),[n,t,l])}function tP(e){let{actionsBoxElement:n,activeIndex:t,children:i,id:l,onActionStart:s,onKeyDown:r,rootRef:a,states:o,...d}=e,c=o[t],u=(0,E.useCallback)(e=>{let n=o.filter(n=>n.shortcut&&(0,ep.ZP)(n.shortcut,e)),t=n[0];if(n.length>1&&console.warn('Keyboard shortcut conflict: More than one document action matches the shortcut "'.concat(t.shortcut,'"')),t&&!t.disabled&&t.onHandle){e.preventDefault(),t.onHandle(),s(o.indexOf(t));return}r&&r(e)},[s,r,o]);return(0,M.jsxs)(L.X6,{id:l,onKeyDown:u,tabIndex:-1,...d,ref:a,children:[i,c&&c.dialog&&(0,M.jsx)(ei.jr5,{zOffset:"paneFooter",children:(0,M.jsx)(n6,{dialog:c.dialog,referenceElement:n})})]})}let tS=E.memo(e=>{let{actionsBoxElement:n,children:t,...i}=e,{actions:l,editState:s}=(0,L.Z3)(),[r,a]=(0,E.useState)(-1),o=(0,E.useCallback)(e=>{a(e)},[]),d=(0,E.useMemo)(()=>s&&{...s,onComplete:()=>void 0,revision:void 0},[s]);return d&&l?(0,M.jsx)(eM,{actionProps:d,actions:l,children:e=>{let{states:l}=e;return(0,M.jsx)(tP,{...i,activeIndex:r,actionsBoxElement:n,onActionStart:o,states:l,children:t})}}):null});tS.displayName="DocumentActionShortcuts";let tz=["fixed","absolute"],tM=(0,ed.ZP)(ei.jbM)(S||(S=eS(["\n  flex: 1;\n  display: flex;\n  min-height: 0;\n  min-width: 0;\n"]))),tE=(0,E.memo)(function(e){let{name:n}=(0,ei.Lky)();return(0,M.jsx)(ei.cWh,{name:e.pane.source||n,children:(0,M.jsx)(tI,{...e})})});function tI(e){var n;let{pane:t,paneKey:i}=e,{resolveNewDocumentOptions:l}=(0,ei.Lky)().document,s=(0,L.RL)(),r=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=(0,ei.zEW)();return(0,E.useMemo)(()=>{if(e.type&&"*"!==e.type)return e;let i=e.template||n.template,l=i?t.find(e=>e.id===i):void 0,s=null==l?void 0:l.schemaType;return s?{...e,type:s}:e},[e,n.template,t])}(t.options,s.params),{documentType:a,isLoaded:o}=(0,ei.Hdz)(r.id,r.type),d=(0,E.useMemo)(()=>l({type:"global"}),[l]),[c,u]=(0,ei.UMU)({templateItems:d}),p=o&&!u,h=(0,E.useMemo)(()=>p&&a&&r.type!==a?{...e,pane:{...e.pane,options:{...r,type:a}}}:e,[e,a,p,r]),{ReferenceChildLink:f,handleEditReference:x,groupIndex:m,routerPanesState:g}=s,j=(null==(n=g[m+1])?void 0:n[0].params)||{},v=g.length,{parentRefPath:y}=j,b=(0,E.useMemo)(()=>y?{path:(0,eh.mL)(y),state:m>=v-1?"none":m>=v-2?"selected":"pressed"}:{path:[],state:"none"},[y,m,v]);return"*"!==r.type||p?a?(0,M.jsx)(nl,{...h,children:(0,M.jsx)(ei.euX,{EditReferenceLinkComponent:f,onEditReference:x,initialValueTemplateItems:c,activePath:b,children:(0,M.jsx)(tL,{})})},a):(0,M.jsx)(e8,{flex:2.5,minWidth:320,paneKey:i,title:(0,M.jsx)(M.Fragment,{children:"The document was not found"}),children:(0,M.jsx)(I.Kq,{space:4,children:(0,M.jsxs)(I.xv,{as:"p",children:["The document type is not defined, and a document with the ",(0,M.jsx)("code",{children:r.id})," ","identifier could not be found."]})})}):(0,M.jsx)(e2,{flex:2.5,minWidth:320,paneKey:i,title:"Loading document…"})}function tL(){let{changesOpen:e,documentType:n,onFocus:t,onPathOpen:i,onHistoryOpen:l,onKeyUp:s,inspectOpen:r,paneKey:a,schemaType:o,value:d}=(0,L.Z3)(),{features:c}=eK(),{collapsed:u}=(0,L.Cc)(),p=(0,ei.Cnp)(),[h,f]=(0,E.useState)(null),[x,m]=(0,E.useState)(null),[g,j]=(0,E.useState)(null),[v,y]=(0,E.useState)(null),b=(0,I.XL)(x),w=null==b?void 0:b.height,k=(0,E.useMemo)(()=>(0,M.jsx)(nQ,{footerHeight:w||null,isInspectOpen:r,rootElement:h,setDocumentPanelPortalElement:y}),[w,h,r]),C=(0,E.useMemo)(()=>(0,M.jsx)(I.Xp,{__unstable_elements:{documentPanelPortalElement:v},children:(0,M.jsx)(I.Tu,{position:tz,zOffset:p.portal,children:(0,M.jsx)(L.PV,{ref:m,children:(0,M.jsx)(t_,{actionsBoxRef:j})})})}),[v,p.portal]),_=(0,E.useMemo)(()=>c.reviewChanges&&e?(0,M.jsx)(I.NM,{element:h,children:(0,M.jsx)(nC,{})}):null,[e,c.reviewChanges,h]),P=(0,E.useCallback)(e=>{i(e),t(e)},[i,t]),S=(0,E.useMemo)(()=>o?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I.Tu,{position:tz,zOffset:p.portal,children:(0,M.jsx)(I.kC,{direction:"column",flex:1,height:u?void 0:"fill",children:(0,M.jsxs)(tM,{"data-testid":"change-connector-root",isReviewChangesOpen:e,onOpenReviewChanges:l,onSetFocus:P,children:[k,_]})})}),C,(0,M.jsx)(e6,{})]}):(0,M.jsx)(e8,{flex:2.5,minWidth:320,paneKey:a,title:(0,M.jsxs)(M.Fragment,{children:["Unknown document type: ",(0,M.jsx)("code",{children:n})]}),tone:"caution",children:(0,M.jsxs)(I.Kq,{space:4,children:[n&&(0,M.jsxs)(I.xv,{as:"p",children:["This document has the schema type ",(0,M.jsx)("code",{children:n}),", which is not defined as a type in the local content studio schema."]}),!n&&(0,M.jsx)(I.xv,{as:"p",children:"This document does not exist, and no schema type was specified for it."}),ei.r8Q&&d&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(I.xv,{as:"p",children:"Here is the JSON representation of the document:"}),(0,M.jsx)(I.Zb,{padding:3,overflow:"auto",radius:2,shadow:1,tone:"inherit",children:(0,M.jsx)(I.EK,{language:"json",size:[1,1,2],children:JSON.stringify(d,null,2)})})]})]})}),[o,p.portal,u,e,l,P,k,_,C,a,n,d]),z=e?920:600,T=e?640:320;return(0,M.jsx)(tS,{actionsBoxElement:g,currentMinWidth:z,"data-testid":"document-pane",flex:2.5,id:a,minWidth:T,onKeyUp:s,rootRef:f,children:S})}function tT(){return(0,M.jsx)(I.Zb,{height:"fill",children:(0,M.jsx)(I.kC,{align:"center",height:"fill",justify:"center",padding:4,sizing:"border",children:(0,M.jsx)(I.W2,{width:0,children:(0,M.jsx)(I.Zb,{padding:4,radius:2,shadow:1,tone:"caution",children:(0,M.jsxs)(I.kC,{children:[(0,M.jsx)(I.xu,{children:(0,M.jsx)(I.xv,{size:1,children:(0,M.jsx)(ec.foC,{})})}),(0,M.jsxs)(I.Kq,{flex:1,marginLeft:3,space:3,children:[(0,M.jsx)(I.xv,{as:"h1",size:1,weight:"bold",children:"No document types"}),(0,M.jsx)(I.xv,{as:"p",muted:!0,size:1,children:"Please define at least one document type in your schema."}),(0,M.jsx)(I.xv,{as:"p",muted:!0,size:1,children:(0,M.jsx)("a",{href:"https://www.sanity.io/docs/create-a-schema-and-configure-sanity-studio",target:"_blank",rel:"noreferrer",children:"Learn how to add a document type →"})})]})]})})})})})}let tR=(0,ed.ZP)(function(e){let{children:n,minWidth:t,onCollapse:i,onExpand:l,...s}=e,r=(0,E.useMemo)(()=>(function(){let e=[],n=[],t=new WeakMap,i=new Set,l={},s=null,r=0,a=null,o=new Map,d=!1;function c(e){i.delete(e),a=e,u()}return{collapse:function(e){i.add(e),a===e&&(a=null),u()},expand:c,mount:function(e,i){return t.set(e,{...i,original:i}),n.push(e),s&&function(e,n){let t=new WeakMap;for(let i of n)t.set(i,function(e,n){let t=[],i=n;for(;i!==e;){let n=i.parentElement;if(!n)break;let l=Array.from(n.childNodes),s=l.indexOf(i);if(t.unshift(s),n===e)break;i=n}return t}(e,i));n.sort((e,n)=>{let i=t.get(e)||eT,l=t.get(n)||eT,s=Math.max(i.length,l.length);for(let e=0;e<s;e+=1){let n=i[e]||-1,t=l[e]||-1;if(n!==t)return n-t}return 0})}(s,n),c(e),()=>{let i=n.indexOf(e);i>-1&&n.splice(i,1),t.delete(e),u()}},resize:function(e,i,s){var r,a,c,p;let h=n.indexOf(i),f=t.get(i);if(!f)return;let x=n[h+1],m=t.get(x);if(m){if("start"===e&&(d=!0,l.left={element:i,flex:f.flex||1,width:i.offsetWidth},l.right={element:x,flex:m.flex||1,width:x.offsetWidth},u()),"move"===e&&l.left&&l.right){o=new Map;let{leftW:e,rightW:n,leftFlex:t,rightFlex:r}=function(e,n,t,i){var l,s;let r={flex:e.left.flex+e.right.flex,width:e.left.width+e.right.width},a=null!=(l=n.minWidth)?l:L.nR,o=null!=(s=t.minWidth)?s:L.nR,d=Math.min(n.maxWidth||1/0,r.width-o),c=Math.min(t.maxWidth||1/0,r.width-a),u=a-e.left.width,p=e.right.width-c;u<p&&(u=p);let h=e.right.width-o,f=d-e.left.width;h>f&&(h=f);let x=Math.min(Math.max(i,u),h),m=e.left.width+x,g=e.right.width-x,j=m/r.width*r.flex,v=g/r.width*r.flex;return{leftFlex:j,leftW:m,rightFlex:v,rightW:g}}(l,f,m,s);o.set(i,{flex:t,width:e}),o.set(x,{flex:r,width:n}),u()}if("end"===e){d=!1;let e=o.get(i),n=o.get(x);t.set(i,{...f,currentMinWidth:0,currentMaxWidth:null!=(r=f.maxWidth)?r:1/0,flex:null!=(a=null==e?void 0:e.flex)?a:f.flex}),t.set(x,{...m,currentMinWidth:0,currentMaxWidth:null!=(c=f.maxWidth)?c:1/0,flex:null!=(p=null==n?void 0:n.flex)?p:m.flex}),o=new Map,delete l.left,delete l.right,u()}}},setRootElement:function(e){s=e},setRootWidth:function(e){r=e,u()},subscribe:function(n){return e.push(n),()=>{let t=e.push(n);t>-1&&e.splice(t,1)}}};function u(){var l,s,c,u;if(!r)return;let p=[];for(let e of n)e!==a&&p.unshift(e);a&&p.unshift(a);let h=new WeakMap,f=p.length,x=p[0],m=(f-1)*L.AA,g=r-m;for(let e of p){let n=t.get(e);if(!n)continue;let r=n.currentMinWidth||n.minWidth||L.nR,a=e===x,d=i.has(e),p=r>g,f=!a&&(d||p),m=o.get(e);h.set(e,{element:e,collapsed:f,currentMinWidth:null!=(l=null==m?void 0:m.width)?l:n.currentMinWidth,currentMaxWidth:null!=(s=null==m?void 0:m.width)?s:n.currentMaxWidth,flex:null!=(u=null!=(c=null==m?void 0:m.flex)?c:n.flex)?u:1}),f?g-=L.AA:g-=r-L.AA}let j=[];for(let e of n){let n=h.get(e);n&&j.push(n)}for(let t of e)t({expandedElement:a||n[n.length-1]||null,panes:j,resizing:d})}})(),[]),[a,o]=(0,E.useState)(null),d=(0,I.XL)(a),c=(null==d?void 0:d.width)||0,u=void 0!==c&&t?c<t:void 0,[p,h]=(0,E.useState)({expandedElement:null,panes:[],resizing:!1});(0,E.useEffect)(()=>r.setRootElement(a),[r,a]),(0,E.useEffect)(()=>r.setRootWidth(c),[r,c]),(0,E.useEffect)(()=>r.subscribe(h),[r]),(0,E.useEffect)(()=>{void 0!==u&&(u&&i&&i(),!u&&l&&l())},[u,i,l]);let f=(0,E.useMemo)(()=>({collapse:r.collapse,collapsed:u,expand:r.expand,expandedElement:p.expandedElement,mount:r.mount,panes:p.panes,resize:r.resize,resizing:p.resizing}),[u,r,p.expandedElement,p.panes,p.resizing]);return(0,M.jsx)(L.yq.Provider,{value:f,children:(0,M.jsx)(L.fC,{"data-ui":"PaneLayout",...s,"data-collapsed":u?"":void 0,"data-resizing":p.resizing?"":void 0,"data-mounted":c?"":void 0,ref:o,children:n})})})(z||(z=eS(["\n  min-height: 100%;\n  min-width: 320px;\n"]))),tO=(0,ep.ZP)("mod+s"),tZ=(0,E.memo)(function(e){var n;let{onPaneChange:t}=e,{push:i}=(0,I.pm)(),l=(0,ei.I_y)(),{layoutCollapsed:s,setLayoutCollapsed:r}=eK(),{paneDataItems:a,resolvedPanes:o}=function(){let[e,n]=(0,E.useState)();if(e)throw e;let{structureContext:t,rootPaneNode:i}=eK(),[l,s]=(0,E.useState)({paneDataItems:[],resolvedPanes:[],routerPanes:[]}),r=function(){let e=(0,E.useMemo)(()=>new N.t(1),[]),n=(0,E.useMemo)(()=>e.asObservable().pipe((0,$.U)(e=>(null==e?void 0:e.panes)||[])),[e]),{state:t}=(0,ea.tv)();return(0,E.useEffect)(()=>{e.next(t)},[t,e]),n}();return(0,E.useEffect)(()=>{let e=(function(e){let{routerPanesStream:n,rootPaneNode:t,initialCacheState:i={cacheKeysByFlatIndex:[],flattenedRouterPanes:[],resolvedPaneCache:new Map,resolvePane:()=>A.C},structureContext:l}=e,s=n.pipe((0,$.U)(e=>[[{id:"root"}],...e]),(0,$.U)(e=>{let n=e.flatMap((e,n)=>e.map((e,t)=>({routerPaneSibling:e,groupIndex:n,siblingIndex:t}))).map((e,n)=>({...e,flatIndex:n}));return n}),(0,q.O)([]),(0,H.G)(),(0,$.U)(e=>{let[n,t]=e;for(let e=0;e<t.length;e++){let i=n[e],l=t[e];if(!er()(i,l))return{flattenedRouterPanes:t,diffIndex:e}}return{flattenedRouterPanes:t,diffIndex:t.length}}),(0,Y.R)((e,n)=>{let{cacheKeysByFlatIndex:t,resolvedPaneCache:i}=e,{flattenedRouterPanes:l,diffIndex:s}=n,r=t.slice(0,s+1),a=t.slice(s+1),o=new Set(r.flatMap(e=>Array.from(e))),d=a.flatMap(e=>Array.from(e)).filter(e=>!o.has(e));for(let e of d)i.delete(e);return{flattenedRouterPanes:l,cacheKeysByFlatIndex:t,resolvedPaneCache:i,resolvePane:eB(e=>(n,l,s)=>{var r,a;let o=n&&"".concat(eZ(n),"-").concat("contextHash(".concat(JSON.stringify({id:l.id,parentId:parent&&eZ(parent),path:l.path,index:l.index,splitIndex:l.splitIndex,serializeOptionsIndex:null==(r=l.serializeOptions)?void 0:r.index,serializeOptionsPath:null==(a=l.serializeOptions)?void 0:a.path}),")")),d=o&&i.get(o);if(d)return d;let c=e(n,l,s);if(!o)return c;let u=t[s]||new Set;return u.add(o),t[s]=u,i.set(o,c),c})}},i),(0,V.w)(e=>{let{flattenedRouterPanes:n,resolvePane:i}=e;return function e(n){let{unresolvedPane:t,flattenedRouterPanes:i,parent:l,path:s,resolvePane:r,structureContext:a}=n,[o,...d]=i,c=d[0],u={id:o.routerPaneSibling.id,splitIndex:o.siblingIndex,parent:l,path:[...s,o.routerPaneSibling.id],index:o.flatIndex,params:o.routerPaneSibling.params||{},payload:o.routerPaneSibling.payload,structureContext:a};try{return r(t,u,o.flatIndex).pipe((0,V.w)(n=>{let i;let p={type:"resolvedMeta",...o,paneNode:n,path:u.path},h=d.map((e,n)=>{let t=[...u.path,...d.slice(n).map((n,t)=>"[".concat(e.flatIndex+t,"]"))],i={type:"loading",path:t,paneNode:null,...e};return i});return d.length?(i=(null==c?void 0:c.routerPaneSibling.id.startsWith("__edit__"))?e({unresolvedPane:eV,flattenedRouterPanes:d,parent:l,path:u.path,resolvePane:r,structureContext:a}):o.groupIndex===(null==c?void 0:c.groupIndex)?e({unresolvedPane:t,flattenedRouterPanes:d,parent:l,path:s,resolvePane:r,structureContext:a}):e({unresolvedPane:"function"==typeof n.child?eF(n,"child"):n.child,flattenedRouterPanes:d,parent:n,path:u.path,resolvePane:r,structureContext:a}),(0,W.z)((0,D.of)([p,...h]),i.pipe((0,$.U)(e=>[p,...e])))):(0,D.of)([p])}))}catch(e){if(e instanceof eR&&(e.context&&console.warn("Pane resolution error at index ".concat(e.context.index).concat(e.context.splitIndex>0?" for split pane index ".concat(e.context.splitIndex):"",": ").concat(e.message).concat(e.helpId?" - see ".concat((0,el.h)(e.helpId)):""),e),"structure-item-returned-no-child"===e.helpId))return(0,D.of)([]);throw e}}({unresolvedPane:t,flattenedRouterPanes:n,parent:null,path:[],resolvePane:i,structureContext:l})}));return s.pipe((0,Y.R)((e,n)=>n.map((n,t)=>{let i=e[t];return i&&"loading"===n.type&&i.routerPaneSibling.id===n.routerPaneSibling.id?i:n}),[]),(0,J.x)((e,n)=>{if(e.length!==n.length)return!1;for(let t=0;t<n.length;t++){let i=e[t],l=n[t];if(e$(i)!==e$(l))return!1}return!0}))})({rootPaneNode:i,routerPanesStream:r,structureContext:t}).pipe((0,$.U)(e=>{let n=e.reduce((e,n)=>{let t=e[n.groupIndex]||[];return t[n.siblingIndex]=n.routerPaneSibling,e[n.groupIndex]=t,e},[]),t=n.length,i=e.map(i=>{var l;let{groupIndex:s,flatIndex:r,siblingIndex:a,routerPaneSibling:o,path:d}=i,c=o.id,u=n[s+1],p={active:s===t-2,childItemId:null!=(l=null==u?void 0:u[0].id)?l:null,index:r,itemId:o.id,groupIndex:s,key:"".concat("loading"===i.type?"unknown":i.paneNode.id,"-").concat(c,"-").concat(a),pane:"loading"===i.type?L.PF:i.paneNode,params:o.params||{},path:d.join(";"),payload:o.payload,selected:r===e.length-1,siblingIndex:a};return p});return{paneDataItems:i,routerPanes:n,resolvedPanes:i.map(e=>e.pane)}})),l=e.subscribe({next:e=>s(e),error:e=>n(e)});return()=>l.unsubscribe()},[i,r,t]),l}(),d=(0,ea.z)((0,E.useCallback)(e=>"string"==typeof e.intent,[])),[c,u]=(0,E.useState)(null),p=(0,E.useCallback)(()=>r(!0),[r]),h=(0,E.useCallback)(()=>r(!1),[r]);(0,E.useEffect)(()=>{o.length&&t(o)},[t,o]),(0,E.useEffect)(()=>{let e=e=>{tO(e)&&(e.preventDefault(),i({closable:!0,id:"auto-save-message",status:"info",title:"Your work is automatically saved!",duration:4e3}))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[i]);let f=null==(n=l._original)?void 0:n.types.some(ei.mPO);return f?(0,M.jsxs)(I.Xp,{element:c||null,children:[(0,M.jsxs)(tR,{flex:1,height:s?void 0:"fill",minWidth:512,onCollapse:p,onExpand:h,children:[a.map(e=>{let{active:n,childItemId:t,groupIndex:i,itemId:l,key:s,pane:r,index:a,params:o,path:d,payload:c,siblingIndex:u,selected:p}=e;return(0,M.jsx)(E.Fragment,{children:r===L.PF?(0,M.jsx)(e2,{paneKey:s,path:d,selected:p}):(0,M.jsx)(e4,{active:n,groupIndex:i,index:a,pane:r,childItemId:t,itemId:l,paneKey:s,params:o,payload:c,path:d,selected:p,siblingIndex:u})},"".concat(r===L.PF?"loading":r.type,"-").concat(a))}),a.length<=1&&d&&(0,M.jsx)(e2,{paneKey:"intent-resolver"})]}),(0,M.jsx)("div",{"data-portal":"",ref:u})]}):(0,M.jsx)(tT,{})});var tD=Object.freeze({__proto__:null,default:function(e){let{tool:{options:n}}=e,{unstable_sources:t}=(0,ei.cFj)(),[i]=t,{source:l,defaultDocumentNode:s,structure:r}=n||{};(0,E.useEffect)(()=>((0,L.aR)([]),()=>(0,L.aR)([])),[]);let[{error:a},o]=(0,E.useState)({error:null});return a?(0,M.jsx)(eG,{error:a}):(0,M.jsx)(I.SV,{onCatch:o,children:(0,M.jsx)(ei.cWh,{name:l||i.name,children:(0,M.jsxs)(L.Sg,{defaultDocumentNode:s,structure:r,children:[(0,M.jsx)(tZ,{onPaneChange:L.aR}),(0,M.jsx)(eY,{})]})})})}})}}]);